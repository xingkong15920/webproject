<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title></title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" href="../../public/css/xadmin.css">
    <script type="text/javascript" src="../../public/js/jquery-3.2.1.js"></script>
    <script type="text/javascript" src="../../public/lib/layui/layui.js"></script>
    <script type="text/javascript" src="../../public/js/xadmin.js"></script>
    <script type="text/javascript" src="../../public/js/hangye.js"></script>
    <script type="text/javascript" src="../../public/js/hangye1.js"></script>
    <script type="text/javascript" src="../../public/js/yinhang.js"></script>
    <!-- 让IE8/9支持媒体查询，从而兼容栅格 -->
    <!--[if lt IE 9]>
      <script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
      <script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style>
        .widthauto {
                width: auto !important;
            }
            
            .tips_red {
                color: red;
            }
            
            .layui-form-label {
                padding-left: 0;
                width: 115px;
            }
            
            .layui-input-block {
                margin-left: 115px;
            }
            
            .layui-elem-quote {
                font-size: 18px;
            }
            
            .layui-elem-field legend {
                font-size: 16px;
            }
            
            .layui-upload-img {
                width: 200px;
                height: 200px;
                margin: 0 10px 40px 0;
            }
            
            .Since_inline {
                display: inline-block;
                width: auto !important;
                line-height: 38px;
            }
            
            .layui-elem-quote .layui-form-switch {
                margin: 0 15px;
                margin-top: 0;
            }
            img{
                text-align: center;
                height: 100%;
            }
            .yingyezhizhao{
                display:inline-block;width:500px;margin-left:30px
            }
            #showImgBox{
                width: 35%;
                height: 60%;
                position: fixed;
                z-index: 99999;
                display: none;
                background-color: #fff;
            }
            .showImg{
                
            }
        </style>
</head>

<body id="iosiframe">
    <div class="x-body">
        <div id="showImgBox">
            <img id="showImg" src="http://sh-upfile.oss-cn-beijing.aliyuncs.com/1004/Merchant/1574146882000/c0b6baa3cad5d2f8cca8d5d5c6ac.jpeg" style="width:100%;height:100%">
        </div>
        <div class="layui-row">
            <div class="layui-form" action="" lay-filter="cardAdd">
                <div class="layui-form-item" id="msg" style="display:none">
                    <label class="layui-form-label">审核失败原因:</label>
                    <div class="layui-input-block">
                        <input type="text" style="color:red;font-weight:bold" name="msg" disabled="" lay-verify="" autocomplete="off" placeholder="" class="layui-input">
                    </div>
                </div>
                <blockquote class="layui-elem-quote">商户信息</blockquote>
                <fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
                    <legend style="font-weight: 500;">注册信息</legend>
                </fieldset>
                <div class="box-item">
                    <div class="layui-form-item" style="display:inline-block;width:500px;position:relative;">
                        <label class="layui-form-label"><span style="color:red;font-size:25px;vertical-align: middle">*</span>商户名称</label>
                        <div class="layui-input-block">
                            <input type="text" lay-verType="tips" name="merchantName" lay-verify="merchantName" autocomplete="off" placeholder="请输入商户名称,建议2-10个汉字" class="layui-input">
                        </div>
                        <i class="layui-icon" id="merchantNameTips" style="position:absolute;right:-25px;top:8px;color:red;cursor:pointer;font-size: 20px;">&#xe60b;</i>
                    </div>
                    <div class="layui-form-item" style="display:inline-block;width:500px;margin-left:30px;position:relative;">
                        <label class="layui-form-label"><span style="color:red;font-size:25px;vertical-align: middle">*</span>注册手机号</label>
                        <div class="layui-input-block">
                            <input type="text" lay-verType="tips" name="registerCell" lay-verify="phone" autocomplete="off" placeholder="该手机号作为商户登录时用，密码默认为后六位" class="layui-input">
                        </div>
                        <!-- <div id="phoneTips" style="position:absolute;right:5px;top:2px;font-weight:bold;color:red;cursor:pointer">?</div> -->
                        <i class="layui-icon" id="phoneTips" style="position:absolute;right:-25px;top:8px;color:red;cursor:pointer;font-size: 20px;">&#xe60b;</i>
                    </div>
                </div>
                <fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
                    <legend style="font-weight: 500;">图片信息</legend>
                </fieldset>
                <div class="layui-form-item layui-form-text" id="businessLicense1">
                    <!-- <label class="layui-form-label">营业执照</label> -->
                    <div class="layui-input-inline  noGeren" style="margin-left:30px;display: none">
                        <div class="layui-upload-img">
                            <img src="../../public/images/add.jpg" id="businessLicense" style="max-width: 100%;">
                            <div class="layui-btn layui-btn-sm block" id="test1" style="width:100%;text-align:center">上传图片</div>
                        </div>
                        <div style="width:100%;text-align:center;width:200px">营业执照</div>
                    </div>
                    <div class="layui-input-inline" style="margin-left:30px;">
                        <div class="layui-upload-img">
                            <img src="../../public/images/add.jpg" id="cashier" style="max-width: 100%;">
                            <div class="layui-btn layui-btn-sm block" id="test2" style="width:100%;text-align:center">上传图片</div>
                        </div>
                        <div style="width:100%;text-align:center;width:200px">收银台照</div>
                    </div>
                    <div class="layui-input-inline" style="margin-left:30px;">
                        <div class="layui-upload-img">
                            <img src="../../public/images/add.jpg" id="placeBusiness" style="max-width: 100%;">
                            <div class="layui-btn layui-btn-sm block" id="test3" style="width:100%;text-align:center">上传图片</div>
                        </div>
                        <div style="width:100%;text-align:center;width:200px">场景照</div>
                    </div>
                    <div class="layui-input-inline" style="margin-left:30px;">
                        <div class="layui-upload-img">
                            <img src="../../public/images/add.jpg" id="doorheadPhoto" style="max-width: 100%;">
                            <div class="layui-btn layui-btn-sm block" id="test4" style="width:100%;text-align:center">上传图片</div>
                        </div>
                        <div style="width:100%;text-align:center;width:200px">门头照</div>
                    </div>
                    <div class="layui-input-inline" style="margin-left:30px;">
                        <div class="layui-upload-img">
                            <img src="../../public/images/add.jpg" id="rests" style="max-width: 100%;">
                            <div class="layui-btn layui-btn-sm block" id="test10" style="width:100%;text-align:center">上传图片</div>
                        </div>
                        <div style="width:100%;text-align:center;width:200px">其他资料</div>
                    </div>
                </div>
                <!--隐藏-->
                <!--基本信息-->
                <fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
                    <legend style="font-weight: 500;">文字信息</legend>
                </fieldset>
                <div class="box-item">
                    <div class="layui-form-item" style="display:inline-block;width:500px">
                        <label class="layui-form-label"><span style="color:red;font-size:25px;vertical-align: middle">*</span>商户类型</label>
                        <div class="layui-input-block widthauto">
                            <!-- <input type="radio" name="merchantType" value="0" title="个人" lay-filter="cardvalid" checked="">
                            <input type="radio" name="merchantType" value="1" title="个体" lay-filter="cardvalid">
                            <input type="radio" name="merchantType" value="2" title="企业" lay-filter="cardvalid"> -->
                            <input type="text" disabled="" name="merchantType" lay-verify="title" autocomplete="off" placeholder="" class="layui-input">
                        </div>
                    </div>
                </div>
                <div class="box-item">
                    <div class="layui-form-item" id="paymentType2" style="display:inline-block;width:auto">
                        <label class="layui-form-label"><span style="color:red;font-size:25px;vertical-align: middle">*</span>经营范围</label>
                        <div class="layui-input-block" style="display:inline-block;width:200px;margin-left:0px;">
                            <select name="oneOperate" id="chOne" lay-filter="chOne" lay-verify="title">
                                <!-- <option value="">一级类目</option>
                                <option value="1">互联网</option>
                                <option value="2">科技</option> -->
                            </select>
                        </div>
                        <div class="layui-input-block" style="display:inline-block;width:200px;margin-left:15px;">
                            <select name="twoOperate" id="chTwo" lay-filter="chTwo" lay-verify="">
                            </select>
                        </div>
                        <div class="layui-input-block" style="display:inline-block;width:200px;margin-left:15px">
                            <select name="threeOperate" id="chThr" lay-filter="chThr" lay-verify="">
                            </select>
                        </div>
                    </div>
                </div>
                <div class="box-item">
                    <div class="layui-form-item" style="display:inline-block;width:500px">
                        <label class="layui-form-label"><span style="color:red;font-size:25px;vertical-align: middle">*</span>费率(%)</label>
                        <div class="layui-input-block" style="position:relative">
                            <input type="text" name="rate" lay-verify="rate" autocomplete="off" placeholder="请输入费率，例如0.38" class="layui-input">
                            <i class="layui-icon" id="zfbRate" style="position:absolute;right:-25px;top:8px;color:red;cursor:pointer;font-size: 20px;">&#xe60b;</i>
                        </div>
                    </div>
                    <div class="layui-form-item noGeren yingyezhizhao" style="display:none">
                        <label class="layui-form-label"><span style="color:red;font-size:25px;vertical-align: middle">*</span>营业执照名称</label>
                        <div class="layui-input-block">
                            <input type="text" name="businessLicenseName" lay-verify="title1" autocomplete="off" placeholder="请输入营业执照名称" class="layui-input">
                        </div>
                    </div>
                </div>
                <div class="box-item noGeren" style="display: none">
                    <div class="layui-form-item BLcn" style="display:inline-block;width:500px">
                        <label class="layui-form-label"><span style="color:red;font-size:25px;vertical-align: middle">*</span>营业执照编号</label>
                        <div class="layui-input-block">
                            <input type="text" name="businessLicenseNo" lay-verify="title1" autocomplete="off" placeholder="请输入营业执照编号" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item" style="display:inline-block;margin-left:30px">
                        <label class="layui-form-label"><span style="color:red;font-size:25px;vertical-align: middle">*</span>营业执照有限期</label>
                        <div class="layui-input-block" style="display:inline-block;width:200px;margin-left:0px;">
                            <input type="text" name="businessLicenseTime" lay-verify="title1" autocomplete="off" placeholder="请选择营业执照有效期" class="layui-input" id="businessLicenseTime">
                        </div>
                        <div style="width:30px;text-align:center;display:inline-block" class="yyNoChangqi">-</div>
                        <div class="layui-input-block yyNoChangqi" style="display:inline-block;width:200px;margin-left:5px;">
                            <input type="text" name="businessLicenseEndTime" lay-verify="title2" autocomplete="off" placeholder="请选择营业执照有效期" class="layui-input" id="businessLicenseEndTime">
                        </div>
                        <div class="layui-input-block" style="display:inline-block;margin-left:15px;vertical-align:top">
                            <input type="checkbox" name="businessLicenseType" lay-skin="switch" lay-filter="businessLicenseType" lay-text="长期|非长期">
                        </div>
                    </div>
                </div>
                <div class="layui-form-item noGeren" style="display:none;width:755px;position:relative;">
                    <label class="layui-form-label"><span style="color:red;font-size:25px;vertical-align: middle">*</span>营业执照地址</label>
                    <div class="layui-input-block">
                        <input type="text" lay-verType="tips" name="businessLicenseAddress" lay-verify="title1" autocomplete="off" placeholder="请输入营业执照地址，必须和营业执照上登记地址一样" class="layui-input">
                    </div>
                </div>
                <div class="box-item">
                    <div class="layui-form-item BLcn" style="display:inline-block;width:500px">
                        <label class="layui-form-label"><span style="color:red;font-size:25px;vertical-align: middle">*</span>邮箱</label>
                        <div class="layui-input-block">
                            <input type="text" name="mailbox" lay-verify="title" autocomplete="off" placeholder="请输入邮箱" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item" style="display:inline-block;margin-left:30px;vertical-align:top">
                        <label class="layui-form-label">是否开通云闪付</label>
                        <div class="layui-input-block" style="display:inline-block;margin-left:0px;vertical-align:top">
                            <!--  <input type="checkbox" name="isOpenYunPay" title="开通"> -->
                            <input type="checkbox" name="isOpenYunPay" lay-skin="switch" lay-filter="isOpenYunPay" lay-text="开通|不开通">
                        </div>
                    </div>
                </div>
                <div class="box-item ysfRate" style="display:none">
                    <div class="layui-form-item " style="display:inline-block;width:500px;position:relative;">
                        <label class="layui-form-label"><span style="color:red;font-size:25px;vertical-align: middle">*</span>云闪付费率1(%)</label>
                        <div class="layui-input-block">
                            <input type="text" name="unionPayRate" lay-verify="unionPayRate" autocomplete="off" placeholder="请输入云闪付费率1" class="layui-input" value="0.52">
                        </div>
                        <i class="layui-icon" id="unionPayRate" style="position:absolute;right:-25px;top:8px;color:red;cursor:pointer;font-size: 20px;">&#xe60b;</i>
                    </div>
                    <div class="layui-form-item " style="display:inline-block;width:500px;margin-left:30px;position:relative">
                        <label class="layui-form-label"><span style="color:red;font-size:25px;vertical-align: middle">*</span>云闪付费率2(%)</label>
                        <div class="layui-input-block">
                            <input type="text" name="unionPayRate2" lay-verify="unionPayRate2" autocomplete="off" placeholder="请输入云闪付费率2" class="layui-input" value="0.52">
                        </div>
                        <i class="layui-icon" id="unionPayRate2" style="position:absolute;right:-25px;top:8px;color:red;cursor:pointer;font-size: 20px;">&#xe60b;</i>
                    </div>
                </div>
                <div class="box-item">
                    <div class="layui-form-item" style="display:inline-block;vertical-align:top">
                        <label class="layui-form-label">是否开通D1</label>
                        <div class="layui-input-block" style="display:inline-block;margin-left:0px;vertical-align:top">
                            <!--  <input type="checkbox" name="isOpenYunPay" title="开通"> -->
                            <input type="checkbox" name="rateType" lay-skin="switch" lay-filter="rateType" lay-text="开通|不开通">
                        </div>
                    </div>
                </div>
                <div class="box-item">
                    <div class="layui-form-item" id="paymentType2" style="display:inline-block;width:auto">
                        <label class="layui-form-label"><span style="color:red;font-size:25px;vertical-align: middle">*</span>公司地址</label>
                        <div class="layui-input-block" style="display:inline-block;width:200px;margin-left:0px;">
                            <select name="prov1" id="prov" lay-filter="prov" lay-verify="title">
                                <!-- <option value="">一级类目</option>
                                <option value="1">互联网</option>
                                <option value="2">科技</option> -->
                            </select>
                        </div>
                        <div class="layui-input-block" style="display:inline-block;width:200px;margin-left:15px;">
                            <select name="city1" id="city" lay-filter="city" lay-verify="">
                            </select>
                        </div>
                        <div class="layui-input-block" style="display:inline-block;width:200px;margin-left:15px">
                            <select name="area1" id="area" lay-filter="area" lay-verify="">
                            </select>
                        </div>
                    </div>
                </div>
                <div class="layui-form-item" style="width:755px;position:relative">
                    <label class="layui-form-label"><span style="color:red;font-size:25px;vertical-align: middle">*</span>商户详细地址</label>
                    <div class="layui-input-block">
                        <input type="text" name="address" lay-verify="title" autocomplete="off" placeholder="请输入商户详细地址" class="layui-input">
                    </div>
                    <i class="layui-icon" id="addressTips" style="position:absolute;right:-25px;top:8px;color:red;cursor:pointer;font-size: 20px;">&#xe60b;</i>
                </div>
                <div class="box-item">
                    <div class="layui-form-item BLcn" style="display:inline-block;width:500px;position:relative;">
                        <label class="layui-form-label">微信号</label>
                        <div class="layui-input-block">
                            <input type="text" name="weChatNo" lay-verify="" autocomplete="off" placeholder="请输入微信号" class="layui-input">
                        </div>
                        <i class="layui-icon" id="wechatTips" style="position:absolute;right:-25px;top:8px;color:red;cursor:pointer;font-size: 20px;">&#xe60b;</i>
                    </div>
                    <div class="layui-form-item BLcn" style="display:inline-block;width:500px;margin-left:30px;position:relative;">
                        <label class="layui-form-label">支付宝号</label>
                        <div class="layui-input-block">
                            <input type="text" name="aliPayNo" lay-verify="" autocomplete="off" placeholder="请输入支付宝号" class="layui-input">
                        </div>
                        <i class="layui-icon" id="alitTips" style="position:absolute;right:-25px;top:8px;color:red;cursor:pointer;font-size: 20px;">&#xe60b;</i>
                    </div>
                </div>
                <div class="box-item">
                    <div class="layui-form-item" style="display:inline-block;margin-left:30px;vertical-align:top">
                        <label class="layui-form-label">是否高校渠道</label>
                        <div class="layui-input-block" style="display:inline-block;margin-left:0px;vertical-align:top">
                            <!--  <input type="checkbox" name="isOpenYunPay" title="开通"> -->
                            <input type="checkbox" name="collegeFlage" lay-skin="switch" lay-filter="collegeFlage" lay-text="是|否">
                        </div>
                    </div>
                </div>
                <blockquote class="layui-elem-quote">法人信息</blockquote>
                <fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
                    <legend style="font-weight: 500;">图片信息</legend>
                </fieldset>
                <div class="layui-form-item layui-form-text" id="businessLicense1">
                    <!-- <label class="layui-form-label">营业执照</label> -->
                    <div class="layui-input-inline" style="margin-left:30px;">
                        <div class="layui-upload-img">
                            <img src="../../public/images/add.jpg" id="juridicalpersonIdPositive" style="max-width: 100%;">
                            <div class="layui-btn layui-btn-sm block" id="test5" style="width:100%;text-align:center">上传图片</div>
                        </div>
                        <div style="width:100%;text-align:center;width:200px">身份证正面</div>
                    </div>
                    <div class="layui-input-inline" style="margin-left:30px;">
                        <div class="layui-upload-img">
                            <img src="../../public/images/add.jpg" id="juridicalpersonIdReverseside" style="max-width: 100%;">
                            <div class="layui-btn layui-btn-sm block" id="test6" style="width:100%;text-align:center">上传图片</div>
                        </div>
                        <div style="width:100%;text-align:center;width:200px">身份证反面</div>
                    </div>
                    <div class="layui-input-inline geren" style="margin-left:30px;">
                        <div class="layui-upload-img">
                            <img src="../../public/images/add.jpg" id="holdId" style="max-width: 100%;">
                            <div class="layui-btn layui-btn-sm block" id="test7" style="width:100%;text-align:center">上传图片</div>
                        </div>
                        <div style="width:100%;text-align:center;width:200px">手持身份证</div>
                    </div>
                </div>
                <fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
                    <legend style="font-weight: 500;">文字信息</legend>
                </fieldset>
                <div class="box-item">
                    <div class="layui-form-item" style="display:inline-block;width:500px">
                        <label class="layui-form-label"><span style="color:red;font-size:25px;vertical-align: middle">*</span>身份证号</label>
                        <div class="layui-input-block">
                            <input type="text" name="juridicalpersonId" lay-verify="title" autocomplete="off" placeholder="请输入身份证号" class="layui-input" id="juridicalpersonId">
                        </div>
                    </div>
                    <div class="layui-form-item" style="display:inline-block;width:500px;margin-left:30px">
                        <label class="layui-form-label"><span style="color:red;font-size:25px;vertical-align: middle">*</span>姓名</label>
                        <div class="layui-input-block">
                            <input type="text" name="juridicalpersonName" lay-verify="title" autocomplete="off" placeholder="请输入姓名" class="layui-input" id="juridicalpersonName">
                        </div>
                    </div>
                </div>
                <div class="box-item">
                    <!-- <div class="layui-form-item BLcn" style="display:inline-block;width:500px">
                        <label class="layui-form-label"><span style="color:red;font-size:25px;vertical-align: middle">*</span>手机号</label>
                        <div class="layui-input-block">
                            <input type="text" name="registerCell" lay-verify="title" autocomplete="off" placeholder="请输入手机号" class="layui-input">
                        </div>
                    </div> -->
                    <div class="layui-form-item" style="display:inline-block;">
                        <label class="layui-form-label"><span style="color:red;font-size:25px;vertical-align: middle">*</span>身份证有效期</label>
                        <div class="layui-input-block" style="display:inline-block;width:200px;margin-left:0px;">
                            <input type="text" name="juridicalpersonIdTime" lay-verify="title" autocomplete="off" placeholder="请选择身份证有效期" class="layui-input" id="juridicalpersonIdTime">
                        </div>
                        <div style="width:30px;text-align:center;display:inline-block" class="sfzNoChangqi">-</div>
                        <div class="layui-input-block sfzNoChangqi" style="display:inline-block;width:200px;margin-left:5px;">
                            <input type="text" name="juridicalPersonIDEndTime" lay-verify="" autocomplete="off" placeholder="请选择身份证有效期" class="layui-input" id="juridicalPersonIDEndTime">
                        </div>
                        <div class="layui-input-block" style="display:inline-block;margin-left:15px;vertical-align:top">
                            <input type="checkbox" name="juridicalPersonIDType" lay-skin="switch" lay-filter="juridicalPersonIDType" lay-text="长期|非长期">
                        </div>
                    </div>
                </div>
                <blockquote class="layui-elem-quote">结算信息</blockquote>
                <div class="box-item">
                    <div class="layui-form-item" style="display:inline-block;vertical-align:top">
                        <label class="layui-form-label">结算卡类型</label>
                        <div class="layui-input-block" style="display:inline-block;margin-left:0px;vertical-align:top" id="gongsi">
                            <!--  <input type="checkbox" name="isOpenYunPay" title="开通"> -->
                            <!-- <input type="radio" name="acntType" value="0" title="对私" lay-filter="cardvalid" checked="" class="duisixuanze">
                            <input type="radio" name="acntType" value="1" title="对公" lay-filter="cardvalid" class="duigongxuanze" style="display:none"> -->
                        </div>
                    </div>
                </div>
                <div class="box-item" id="farenxuanze" style="display:none">
                    <div class="layui-form-item" style="display:inline-block;vertical-align:top">
                        <label class="layui-form-label"></label>
                        <div class="layui-input-block" id="farenBox" style="display:inline-block;margin-left:0px;vertical-align:top">
                            <!--  <input type="checkbox" name="isOpenYunPay" title="开通"> -->
                        </div>
                    </div>
                </div>
                <fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
                    <legend style="font-weight: 500;">图片信息</legend>
                </fieldset>
                <div class="layui-form-item layui-form-text" id="businessLicense1">
                    <!-- <label class="layui-form-label">营业执照</label> -->
                    <div class="layui-input-inline kaihu" style="margin-left:30px;display:none">
                        <div class="layui-upload-img">
                            <img src="../../public/images/add.jpg" id="openingPermit" style="max-width: 100%;">
                            <div class="layui-btn layui-btn-sm block" id="test8" style="width:100%;text-align:center;width:200px">上传图片</div>
                        </div>
                        <div style="width:100%;text-align:center;">开户许可证</div>
                    </div>
                    <div class="layui-input-inline yinhangka" style="margin-left:30px;">
                        <div class="layui-upload-img">
                            <img src="../../public/images/add.jpg" id="bankCardPositive" style="max-width: 100%;">
                            <div class="layui-btn layui-btn-sm block" id="test9" style="width:100%;text-align:center">上传图片</div>
                        </div>
                        <div style="width:100%;text-align:center;width:200px">银行卡正面</div>
                    </div>
                </div>
                <div class="layui-form-item layui-form-text feifaren">
                    <!-- <label class="layui-form-label">营业执照</label> -->
                    <div class="layui-input-inline" style="margin-left:30px;">
                        <div class="layui-upload-img">
                            <img src="../../public/images/add.jpg" id="settlementPersonPositive" style="max-width: 100%;">
                            <div class="layui-btn layui-btn-sm block" id="test11" style="width:100%;text-align:center">上传图片</div>
                        </div>
                        <div style="width:100%;text-align:center;width:200px">结算人身份证正面</div>
                        <div style="width:100%;text-align:center;width:200px;line-height:40px;color:#666666" onmouseover="shili(9)" onmouseout="shilihide()"><i class="layui-icon" id="shili1" style="color:#009688">&#xe615;</i>预览示例图</div>
                        <img class="shili" src="" style="width:200;height:100px;position:absolute;right:0;bottom:0;z-index:9999">
                    </div>
                    <div class="layui-input-inline" style="margin-left:30px;">
                        <div class="layui-upload-img">
                            <img src="../../public/images/add.jpg" id="settlementPersonReverseside" style="max-width: 100%;">
                            <div class="layui-btn layui-btn-sm block" id="test12" style="width:100%;text-align:center">上传图片</div>
                        </div>
                        <div style="width:100%;text-align:center;width:200px">结算人身份证反面</div>
                        <div style="width:100%;text-align:center;width:200px;line-height:40px;color:#666666" onmouseover="shili(10)" onmouseout="shilihide()"><i class="layui-icon" id="shili1" style="color:#009688">&#xe615;</i>预览示例图</div>
                        <img class="shili" src="" style="width:200;height:100px;position:absolute;right:0;bottom:0;z-index:9999">
                    </div>
                    <div class="layui-input-inline" style="margin-left:30px;">
                        <div class="layui-upload-img">
                            <img src="../../public/images/add.jpg" id="holdId2" style="max-width: 100%;">
                            <div class="layui-btn layui-btn-sm block" id="test13" style="width:100%;text-align:center">上传图片</div>
                        </div>
                        <div style="width:100%;text-align:center;width:200px">结算人手持身份证</div>
                        <div style="width:100%;text-align:center;width:200px;line-height:40px;color:#666666" onmouseover="shili(11)" onmouseout="shilihide()"><i class="layui-icon" id="shili1" style="color:#009688">&#xe615;</i>预览示例图</div>
                        <img class="shili" src="" style="width:200;height:100px;position:absolute;right:0;bottom:0;z-index:9999">
                    </div>
                    <div class="layui-input-inline" style="margin-left:30px;">
                        <div class="layui-upload-img">
                            <img src="../../public/images/add.jpg" id="letterOfAuthPic" style="max-width: 100%;">
                            <div class="layui-btn layui-btn-sm block" id="test14" style="width:100%;text-align:center">上传图片</div>
                        </div>
                        <div style="width:100%;text-align:center;width:200px">结算授权书</div>
                        <div style="width:100%;text-align:center;width:200px;line-height:20px;border:#eee;cursor:pointer;color:rgb(62, 132, 233);" id="down-shouquan">下载模板</div>
                    </div>
                    <div class="layui-input-inline xdlneed" style="margin-left:30px;">
                        <div class="layui-upload-img">
                            <img src="../../public/images/add.jpg" id="authorizationPhoto" style="max-width: 100%;">
                            <div class="layui-btn layui-btn-sm block" id="test15" style="width:100%;text-align:center">上传图片</div>
                        </div>
                        <div style="width:100%;text-align:center;width:200px"><span style="color:red;font-size:25px;vertical-align: middle">*</span>授权书合影</div>
                        <div style="width:100%;text-align:center;width:200px;line-height:20px;border:#eee;color:red">*仅开通新大陆通道时上传</div>
                    </div>
                </div>
                <fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
                    <legend style="font-weight: 500;">文字信息</legend>
                </fieldset>
                <div class="box-item feifaren">
                    <div class="layui-form-item" style="display:inline-block;width:500px">
                        <label class="layui-form-label"><span style="color:red;font-size:25px;vertical-align: middle">*</span>结算人身份证号</label>
                        <div class="layui-input-block">
                            <div class="layui-input-clear"><i class="layui-icon layui-unselect layui-tab-close">ဆ</i></div>
                            <input type="text" lay-verType="tips" name="settlementPersonID" lay-verify="title4" autocomplete="off" placeholder="请输入身份证号" class="layui-input" id="settlementPersonID">
                        </div>
                    </div>
                    <div class="layui-form-item" style="display:inline-block;width:500px;margin-left:30px">
                        <label class="layui-form-label"><span style="color:red;font-size:25px;vertical-align: middle">*</span>结算人姓名</label>
                        <div class="layui-input-block">
                            <div class="layui-input-clear"><i class="layui-icon layui-unselect layui-tab-close">ဆ</i></div>
                            <input type="text" lay-verType="tips" name="settlementPersonName" lay-verify="title4" autocomplete="off" placeholder="请输入姓名" class="layui-input" id="settlementPersonName">
                        </div>
                    </div>
                </div>
                <div class="box-item feifaren">
                    <div class="layui-form-item" style="display:inline-block">
                        <label class="layui-form-label"><span style="color:red;font-size:25px;vertical-align: middle">*</span>结算人身份证有效期</label>
                        <div class="layui-input-block" style="display:inline-block;width:200px;margin-left:0px;">
                            <div class="layui-input-clear"><i class="layui-icon layui-unselect layui-tab-close">ဆ</i></div>
                            <input type="text" lay-verType="tips" name="acntArtifidStartTime" lay-verify="title4" autocomplete="off" placeholder="请选择身份证有效期" class="layui-input" id="acntArtifidStartTime">
                        </div>
                        <div style="width:30px;text-align:center;display:inline-block" class="sfzNoChangqi1">-</div>
                        <div class="layui-input-block sfzNoChangqi1" style="display:inline-block;width:200px;margin-left:5px;">
                            <div class="layui-input-clear"><i class="layui-icon layui-unselect layui-tab-close">ဆ</i></div>
                            <input type="text" lay-verType="tips" name="acntArtifidTime" lay-verify="title5" autocomplete="off" placeholder="请选择身份证有效期" class="layui-input" id="acntArtifidTime">
                        </div>
                        <div class="layui-input-block" style="display:inline-block;margin-left:15px;vertical-align:top">
                            <input type="checkbox" name="acntArtifIdType" lay-skin="switch" lay-filter="acntArtifIdType" lay-text="长期|非长期">
                        </div>
                    </div>
                </div>
                <div class="box-item feifaren">
                    <div class="layui-form-item" style="display:inline-block;width:500px;position:relative;">
                        <label class="layui-form-label"><span style="color:red;font-size:25px;vertical-align: middle">*</span>预留手机号</label>
                        <div class="layui-input-block">
                            <div class="layui-input-clear"><i class="layui-icon layui-unselect layui-tab-close">ဆ</i></div>
                            <input type="text" lay-verType="tips" name="reserveCell" lay-verify="title6" autocomplete="off" placeholder="该手机号为银行卡预留手机号" class="layui-input">
                        </div>
                    </div>
                </div>
                <div class="box-item">
                    <div class="layui-form-item" style="display:inline-block;width:500px">
                        <label class="layui-form-label"><span style="color:red;font-size:25px;vertical-align: middle">*</span>银行卡号</label>
                        <div class="layui-input-block">
                            <input type="text" name="bankCardNo" lay-verify="title" autocomplete="off" placeholder="请输入银行卡号" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item" style="display:inline-block;width:500px;margin-left:30px">
                        <label class="layui-form-label"><span style="color:red;font-size:25px;vertical-align: middle">*</span>开户银行</label>
                        <div class="layui-input-block">
                            <!-- <input type="text" name="openingBank" lay-verify="title" autocomplete="off" placeholder="请输入开户银行" class="layui-input"> -->
                            <select name="openingBank1" lay-verify="openingBank" lay-search="" id="openingBank">
                            </select>
                        </div>
                    </div>
                </div>
                <div class="box-item">
                    <div class="layui-form-item" id="paymentType2" style="display:inline-block;width:auto">
                        <label class="layui-form-label"><span style="color:red;font-size:25px;vertical-align: middle">*</span>开户地区</label>
                        <div class="layui-input-block" style="display:inline-block;width:182px;margin-left:0px;">
                            <select name="prov11" id="prov1" lay-filter="prov1" lay-verify="title">
                                <!-- <option value="">一级类目</option>
                                <option value="1">互联网</option>
                                <option value="2">科技</option> -->
                            </select>
                        </div>
                        <div class="layui-input-block" style="display:inline-block;width:183px;margin-left:15px;">
                            <select name="city11" id="city1" lay-filter="city1" lay-verify="">
                            </select>
                        </div>
                    </div>
                    <div class="layui-form-item" style="display:inline-block;width:500px;margin-left:30px">
                        <label class="layui-form-label"><span style="color:red;font-size:25px;vertical-align: middle">*</span>开户支行</label>
                        <div class="layui-input-block">
                            <input type="text" name="openingBankBranch" lay-verify="openingBankBranch" autocomplete="off" placeholder="请搜索并选择开户支行" class="layui-input" id="openingBankBranch" onblur="bl2()" onfocus="fc2()">
                            <div class="layui-input-block" style="position:absolute;top:34px;left:0;z-index:500;max-height:190px;overflow:auto;background-color:#fff;width:100%;margin-left:0;display:none" id="searchBox2">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="box-item">
                    
                    <div class="layui-form-item" style="display:inline-block;vertical-align:top">
                        <label class="layui-form-label">是否开通返利商家</label>
                        <div class="layui-input-block" style="display:inline-block;margin-left:0px;vertical-align:top">
                            <!--  <input type="checkbox" name="isOpenYunPay" title="开通"> -->
                            <input type="checkbox" name="fanli" lay-skin="switch" lay-filter="isfanli" lay-text="开通|不开通">
                        </div>
                    </div>
                </div>
                <div class="box-item fanliBox" style="display:none">
                    <div class="layui-form-item " style="display:inline-block;width:500px;position:relative;">
                        <label class="layui-form-label">返佣比例(%)</label>
                        <div class="layui-input-block">
                            <div class="layui-input-clear"><i class="layui-icon layui-unselect layui-tab-close">ဆ</i></div>
                            <input type="text" name="separateRatio" lay-verify="fanli1" autocomplete="off" placeholder="商家最大返佣比例" class="layui-input" value="">
                        </div>
                    </div>
                   
                </div>
                <blockquote class="layui-elem-quote">其他信息</blockquote>
                <div class="box-item">
                    <div class="layui-form-item" style="display:inline-block;width:500px">
                        <label class="layui-form-label">所属服务商</label>
                        <div class="layui-input-block">
                            <input type="text" name="agName" lay-verify="agentName" autocomplete="off" placeholder="请搜索并选择服务商" class="layui-input" id="agName" onblur="bl()" onfocus="fc()" disabled="">
                            <div class="layui-input-block" style="position:absolute;top:34px;left:0;z-index:500;max-height:190px;overflow:auto;background-color:#fff;width:100%;margin-left:0;display:none" id="searchBox">
                                <!-- <div class="layui-btn layui-btn-primary" style="width:100%;margin-left:0" >121212</div>
                                    <div class="layui-btn layui-btn-primary" style="width:100%;margin-left:0" >121212</div>
                                    <div class="layui-btn layui-btn-primary" style="width:100%;margin-left:0" >121212</div>
                                    <div class="layui-btn layui-btn-primary" style="width:100%;margin-left:0" >121212</div>
                                    <div class="layui-btn layui-btn-primary" style="width:100%;margin-left:0" >121212</div> -->
                            </div>
                        </div>
                    </div>
                    <div class="layui-form-item" style="display:inline-block;width:500px;margin-left:30px">
                        <label class="layui-form-label">所属销售</label>
                        <div class="layui-input-block">
                            <input type="text" name="slName" lay-verify="saleName" autocomplete="off" placeholder="请搜索并选择销售" class="layui-input" id="slName" onblur="bl1()" onfocus="fc1()" disabled="">
                            <div class="layui-input-block" style="position:absolute;top:34px;left:0;z-index:500;max-height:190px;overflow:auto;background-color:#fff;width:100%;margin-left:0;display:none" id="searchBox1">
                            </div>
                        </div>
                    </div>
                </div>
                <!--  <div class="box-item" style="margin-bottom:150px">
                    <div class="layui-form-item" style="display:inline-block">
                        <label class="layui-form-label">进件通道</label>
                        <div class="layui-input-block" id="paymentBox">
                        </div>
                    </div>
                </div> -->
                <div class="layui-form-item layui-layout-admin">
                    <div class="layui-input-block">
                        <div class="layui-footer" style="left: 0;text-align: center;">
                            <button class="layui-btn" lay-submit="" lay-filter="add">立即提交</button>
                            <span class="layui-btn layui-btn-primary" id="chongzhi">重置</span>
                            <span class="layui-btn layui-btn-primary" id="quxiao">取消</span>
                        </div>
                        <!--<i class="layui-icon" lay-tips="推荐追求开发效率和缺乏前端开发经验的使用，后端开发者的最爱。">123123123</i>-->
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="../../common/config-agent.js"></script>
    <script src="../../common/utility.js"></script>
    <script>
    var index = parent.layer.getFrameIndex(window.name);
    $('#quxiao').click(function() {
        console.log('123')
        setTimeout(function() { parent.layer.close(index) }, 16);
    })
    $('#chongzhi').click(function() {
        window.location.reload()
    })
    var userNumber = JSON.parse(sessionStorage.getItem('saleUser')).institutionNumber;
    // var server = 'http://192.168.110.25:6005/shanhe-admin/'
    //var commonServer = 'http://192.168.110.112:6008/shanhe-common/'
    // var jgServer = 'http://192.168.110.25:6005/shanhe-admin/'
    // //var server = 'https://nb.51shanhe.com/shanhe-admin/'
    var server = 'https://nb.51shanhe.com/shanhe-admin/'
     var commonServer = 'https://nb.hongsou.com.cn/shanhe-common/'
    var jgServer = 'https://nb.51shanhe.com/shanhe-admin/'
    var operlistOne = []
    var operlistTwo = []
    var operlistThr = []
    var prov = []
    var city = []
    var area = []
    var imgList = new Object()
    var longTime = Date.parse(new Date())
    var businessLicense = ''
    var cashier = ''
    var placeBusiness = ''
    var doorheadPhoto = ''
    var juridicalpersonIdPositive = ''
    var juridicalpersonIdReverseside = ''
    var holdId = ''
    var openingPermit = ''
    var bankCardPositive = ''
    var juridicalPersonIDType = 1
    var businessLicenseType = 1
    var isOpenYunPay = 1
    var merchantNumber = CmsUtility.getQueryString('merchantNumber')
    var orderNumber = CmsUtility.getQueryString('orderNumber')
    //var merchantNumber = '1004000563'
    var channelType = CmsUtility.getQueryString('type')
    var channelName = CmsUtility.getQueryString('name')
    var channel = CmsUtility.getQueryString('channel')
    console.log(channelType, channelName, channel)
    var merInfo = ''
    var paymentInfo = ''
    var payList = ''
    var merType = 0
    var baidu = JSON.parse(sessionStorage.getItem('baidu'))
    var rateType = 'T1'
    var legalFlag = 0
    var acntType = '对私'
    var acntArtifIdType = 1
    var separateType = 1
     $('#down-shouquan').click(function(){
        window.open('../../public/file/shouquan.zip')
    })
    //判断是否有？
    function readFile(obj) {

        var file = obj.files[0];
        //判断类型是不是图片 
        if (!/image\/\w+/.test(file.type)) {
            alert("请确保文件为图像类型");
            return false;
        }
        var reader = new FileReader();
        reader.readAsDataURL(file);
        reader.onload = function(e) {
            var index = layer.load(2, { shade: [0.4, '#393D49'] })
            dealImage(this.result, { width: 200 }, function(base) {

                console.log(base)
                fileup(base)
            });
        }
    }

    function dataURLtoFile(dataurl, filename) { //将base64转换为文件  
        var arr = dataurl.split(','),
            mime = arr[0].match(/:(.*?);/)[1],
            bstr = atob(arr[1]),
            n = bstr.length,
            u8arr = new Uint8Array(n);
        while (n--) {
            u8arr[n] = bstr.charCodeAt(n);
        }
        return new File([u8arr], filename, { type: mime });
    }

    /**   
     * 图片压缩，默认同比例压缩
     * @param {Object} path
     * pc端传入的路径可以为相对路径，但是在移动端上必须传入的路径是照相图片储存的绝对路径
     * @param {Object} obj
     * obj 对象 有 width， height， quality(0-1)
     * @param {Object} callback
     * 回调函数有一个参数，base64的字符串数据
     */
    function dealImage(path, obj, callback) {
        var index = layer.load(2, { shade: [0.4, '#393D49'] })
        var img = new Image();
        img.src = path;
        img.onload = function() {
            var that = this;
            // 默认按比例压缩
            var w = that.width,
                h = that.height,
                scale = w / h;
            w = 1200;
            h = 1200 / scale;
            var quality = 0.8; // 默认图片质量为0.7
            //生成canvas
            var canvas = document.createElement('canvas');
            var ctx = canvas.getContext('2d');
            // 创建属性节点
            var anw = document.createAttribute("width");
            anw.nodeValue = w;
            var anh = document.createAttribute("height");
            anh.nodeValue = h;
            canvas.setAttributeNode(anw);
            canvas.setAttributeNode(anh);
            ctx.drawImage(that, 0, 0, w, h);
            // 图像质量
            if (obj.quality && obj.quality <= 1 && obj.quality > 0) {
                quality = obj.quality;
            }
            // quality值越小，所绘制出的图像越模糊
            var base64 = canvas.toDataURL('image/jpeg', quality);
            // 回调函数返回base64的值
            callback(base64);
        }
    }

    function uploadImage(name, type) {

        // 创建一个 form ，如果存在，则先删除
        var form1 = document.getElementById("tempform1");
        if (form1)
            document.body.removeChild(form1);

        form1 = document.createElement("form");
        form1.id = "tempform1";
        form1.name = "tempform1";
        document.body.appendChild(form1);

        var fileType = document.createElement("input");
        fileType.type = "text";
        fileType.name = "fileType";
        fileType.id = "fileType";

        var file = document.createElement("input");
        file.type = "file";
        file.name = "file";
        file.id = "file";
        file.accept = "image/jpeg,image/jpg,image/png"

        file.onchange = function() {
            var file = this.files[0];
            //判断类型是不是图片 
            if (!/image\/\w+/.test(file.type)) {
                alert("请确保文件为图像类型");
                return false;
            }
            var reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = function(e) {
                dealImage(this.result, { width: 200 }, function(base) {


                    fileup(base, name, type)
                });
            }
        }
        file.click();
        $('#tempform1').hide()
    }

    function farenBox() {
        var str = ' <input type="radio" name="legalFlag" value="0" title="法人" lay-filter="legalFlag" checked=""> <input type="radio" name="legalFlag" value="1" title="非法人" lay-filter="legalFlag">'
        $('#farenBox').html(str)
    }

    function isWen(data) {
        console.log(data)
        if (!data) {
            return ''
        }
        if (data.indexOf('?') >= 0) {
            return data.split('?')[0]
        } else {
            return data
        }
    }
    //判断链接是否为空
    function isNull(data) {
        if (!data) {
            return '../../public/images/add.jpg'
        } else {
            return data
        }
    }
    $('.layui-upload-img').mouseover(function() {
        // console.log(this.getElementsByTagName('img')[0].getAttribute('src'))
        console.dir(this.childNodes[1])
        if (this.childNodes[1].currentSrc.indexOf('images/add.jpg') >= 0 || this.childNodes[1].currentSrc == '') {
            return
        }
        $('#showImg').attr('src', this.childNodes[1].currentSrc)
        $('#showImgBox').css({
            'left': this.childNodes[1].x + 200,
            'top': this.childNodes[1].y
        })
        $('#showImgBox').show()
    })
    $('.layui-upload-img').mouseout(function() {
        // console.log(this.getElementsByTagName('img')[0].getAttribute('src'))
        // console.dir(this.childNodes[1])
        // $('#showImgBox').css({
        //    'left':this.childNodes[1].x + 200,
        //    'top':this.childNodes[1].y
        // })
        $('#showImgBox').hide()
    })

    function fourStr(data) {
        return data.substring(0, 4) + '-' + data.substring(4, 6) + '-' + data.substring(6, 8)
    }

    function bl() {
        setTimeout(function() {
            $('#searchBox').hide()
        }, 200)
        //$('#searchBox').hide()
    }

    function clickS(e) {
        $('#agName').val(e.getAttribute('data-name'))
        $('#agName').attr('agentNumber', e.getAttribute('data-id'))
        $('#agName').attr('agentType', e.getAttribute('data-level'))
        $('#searchBox').hide()
    }

    function fc() {
        $('#searchBox').show()
        CmsUtility.postAjaxCall2(
            //系统设置
            server + 'InsMer/getInsAgent', {

                "institutionNumber": userNumber,
                "agentNumber": JSON.parse(sessionStorage.getItem('saleUser')).Number,
                "agentName": $('#agName').val(),
                "page": 1,
                "limit": '100',
            },
            function(data) {
                console.log(this.value)
                if (data.code == 1000) {
                    var nb = new Object()
                    nb.agentNumber = JSON.parse(sessionStorage.getItem('saleUser')).Number
                    nb.agentName = JSON.parse(sessionStorage.getItem('saleUser')).agentName
                    data.data.agentlist.unshift(nb)
                    var str = ''
                    for (var i = 0; i < data.data.agentlist.length; i++) {
                        str += '<div class="layui-btn layui-btn-primary"  data-id="' + data.data.agentlist[i].agentNumber + '" data-name="' + data.data.agentlist[i].agentName + '" style="width:100%;margin-left:0" onclick="clickS(this)" >' + '[' + data.data.agentlist[i].agentNumber + ']' + data.data.agentlist[i].agentName + '</div>'
                    }
                    document.getElementById('searchBox').innerHTML = str

                    // layer.msg('保存成功')
                    // setTimeout(function(){
                    //  x_admin_close()
                    // },500);

                } else {
                    var nb = new Object()
                    nb.agentNumber = JSON.parse(sessionStorage.getItem('saleUser')).Number
                    nb.agentName = JSON.parse(sessionStorage.getItem('saleUser')).agentName
                    var str = ''
                    str = '<div class="layui-btn layui-btn-primary"  data-id="' + nb.agentNumber + '" data-name="' + nb.agentName + '" style="width:100%;margin-left:0" onclick="clickS(this)" >' + '[' + nb.agentNumber + ']' + nb.agentName + '</div>'

                    document.getElementById('searchBox').innerHTML = str
                }
            },
            function(data) {
                console.log('222')
            }
        )

    }

    function bl1() {
        setTimeout(function() {
            $('#searchBox1').hide()
        }, 200)
        //$('#searchBox').hide()
    }

    function clickS1(e) {
        $('#slName').val(e.getAttribute('data-name'))
        $('#slName').attr('saleNumber', e.getAttribute('data-id'))
        $('#searchBox1').hide()
    }

    function fc1() {
        if (!$('#agName').attr('agentnumber')) {
            layer.msg('请先选择服务商')
            return
        }
        $('#searchBox1').show()
        console.log($('#slName').val())
        CmsUtility.postAjaxCall2(
            //系统设置
            server + 'InsMer/getAgentSale', {

                "agentNumber": $('#agName').attr('agentnumber'),
                "saleName": $('#slName').val(),
                "page": 1,
                "limit": '100',
            },
            function(data) {
                console.log(this.value)
                if (data.code == 1000) {

                    var str = ''
                    console.log(data.data.agentSale)
                    for (var i = 0; i < data.data.agentSale.length; i++) {
                        str += '<div class="layui-btn layui-btn-primary" data-id="' + data.data.agentSale[i].saleNumber + '" data-name="' + data.data.agentSale[i].saleName + '" style="width:100%;margin-left:0" onclick="clickS1(this)" >' + '[' + data.data.agentSale[i].saleNumber + ']' + data.data.agentSale[i].saleName + '</div>'
                    }
                    document.getElementById('searchBox1').innerHTML = str

                    // layer.msg('保存成功')
                    // setTimeout(function(){
                    //  x_admin_close()
                    // },500);

                } else {
                    layer.msg(data.msg)
                    $('#searchBox1').hide()

                }
            },
            function(data) {
                console.log('222')
            }
        )

    }

    function bl2() {
        setTimeout(function() {
            $('#searchBox2').hide()
        }, 200)
        //$('#searchBox').hide()
    }

    function clickS2(e) {
        $('#openingBankBranch').val(e.getAttribute('data-name'))
        $('#openingBankBranch').attr('openingBankNumber', e.getAttribute('data-id'))
        $('#openingBankBranch').attr('openingBankName', e.getAttribute('data-name'))
        $('#searchBox2').hide()
    }

    function fc2() {

        if ($('#openingBank').val() == '') {
            layer.msg('请先选择开户银行')
            return
        }
        $('#searchBox2').show()

        CmsUtility.postAjaxCall2(
            //系统设置
            commonServer + 'cache/getBank', {
                "bankCode": $('#openingBank').val().split('|')[0],
                "paymentType": '4',
                "bankName": $('#openingBankBranch').val(),
                "page": 1,
                "limit": '100',
                "provNm": $('#prov1').val().split('|')[1],
                "cityNm": $('#city1').val().split('|')[1],
            },
            function(data) {
                console.log(this.value)
                if (data.code == 1000) {

                    var str = ''
                    for (var i = 0; i < data.data.selectBank.length; i++) {
                        str += '<div class="layui-btn layui-btn-primary" data-id="' + data.data.selectBank[i].lbnkNo + '" data-name="' + data.data.selectBank[i].lbnkNm + '" style="width:100%;margin-left:0" onclick="clickS2(this)" >' + data.data.selectBank[i].lbnkNm + '</div>'
                    }
                    document.getElementById('searchBox2').innerHTML = str

                    // layer.msg('保存成功')
                    // setTimeout(function(){
                    //  x_admin_close()
                    // },500);

                } else {
                    layer.msg(data.msg)
                    $('#searchBox1').hide()

                }
            },
            function(data) {
                console.log('222')
            }
        )

    }
    // chOne
    // chTwo
    // chThr
    $('#wechatTips').mouseover(function() {
        var that = this;
        layer.tips('请填写商户联系人微信信息,微信要求已绑定银行卡完成实名认证，且实名的姓名与所填写的联系人姓名一致，微信号：需打开微信，在 "个人信息" 中看到的 "微信号",如 "微信号" 一栏显示 "未设置"，需先进行设置', that, {
            tips: [2],
            time: 20000
        });
    })
    $('#wechatTips').mouseout(function() {
        layer.closeAll()
    })
    $('#phoneTips').mouseover(function() {
        var that = this;
        layer.tips('该手机号做为商户登录时用，密码默认为后六位', that, {
            tips: [2],
            time: 20000
        });
    })
    $('#phoneTips').mouseout(function() {
        layer.closeAll()
    })
    layui.use(['laydate', 'table', 'upload', 'form'], function() {
        var $ = layui.jquery,
            upload = layui.upload,
            laydate = layui.laydate,
            table = layui.table,
            form = layui.form,
            admin = layui.admin,
            element = layui.element,
            layer = layui.layer;

        // var index = layer.load(2, { shade: [0.4, '#393D49'] })
        var tableSelect = layui.tableSelect;
        window.isAcnt = function() {
            //商户类型为2时为企业
            var str = ''
            if (merType == 2) {
                str = ' <input type="radio" name="acntType" value="0" title="对私" lay-filter="acntType" checked=""><input type="radio" name="acntType" value="1" title="对公" lay-filter="acntType" >'
            } else {
                str = '<input type="radio" name="acntType" value="0" title="对私" lay-filter="acntType" checked="">'

            }
            $('#gongsi').html(str)
            form.render()
        }
        isAcnt()
        //开户银行
        if (baidu == 'no') {
            layer.msg('未查询到百度API，暂时无法使用图片识别')
        }
        var hangStr = '<option value="">请搜索或选择银行</option>'
        for (var i = 0; i < hangbie.length; i++) {
            hangStr += '<option value=' + hangbie[i].value + '|' + hangbie[i].text + '>' + hangbie[i].text + '</option>'
        }
        $('#openingBank').html(hangStr)
        //查询代理商
        $("#agName").bind('input propertychange', function() {
            console.log(this.value)
            $('#agName').removeAttr('agentNumber')
            $('#agName').removeAttr('agentType')
            document.getElementById('searchBox').innerHTML = ''
            CmsUtility.postAjaxCall2(
                //系统设置
                server + 'InsMer/getInsAgent', {


                    "institutionNumber": userNumber,
                    "agentNumber": JSON.parse(sessionStorage.getItem('saleUser')).Number,
                    "agentName": $('#agName').val(),
                    "page": 1,
                    "limit": '100',
                },
                function(data) {
                    console.log(this.value)
                    if (data.code == 1000) {
                        // if(data.data == null){
                        //     layer.msg(data.msg)
                        //     return
                        //    }
                        var str = ''
                        for (var i = 0; i < data.data.agentlist.length; i++) {
                            str += '<div class="layui-btn layui-btn-primary"   data-id="' + data.data.agentlist[i].agentNumber + '" data-name="' + data.data.agentlist[i].agentName + '" style="width:100%;margin-left:0" onclick="clickS(this)" >' + '[' + data.data.agentlist[i].agentNumber + ']' + data.data.agentlist[i].agentName + '</div>'
                        }
                        document.getElementById('searchBox').innerHTML = str


                    } else {
                        layer.msg(data.msg)
                        $('#searchBox').hide()

                    }
                },
                function(data) {
                    console.log('222')
                }
            )
        })
        $("#slName").bind('input propertychange', function() {
            console.log(this.value)
            if (!$('#agName').attr('agentnumber')) {
                layer.msg('请先选择服务商')
                return
            }
            $('#slName').removeAttr('agentNumber')

            document.getElementById('searchBox1').innerHTML = ''
            CmsUtility.postAjaxCall2(
                //系统设置
                server + 'InsMer/getAgentSale', {

                    "agentNumber": $('#agName').attr('agentnumber'),
                    "saleName": $('#slName').val(),
                    "page": 1,
                    "limit": '100',
                },
                function(data) {
                    console.log(this.value)
                    if (data.code == 1000) {
                        // if(data.data == null){
                        //     layer.msg(data.msg)
                        //     return
                        //    }
                        var str = ''
                        for (var i = 0; i < data.data.agentSale.length; i++) {
                            str += '<div class="layui-btn layui-btn-primary"  data-id="' + data.data.agentSale[i].saleNumber + '" data-name="' + data.data.agentSale[i].saleName + '" style="width:100%;margin-left:0" onclick="clickS1(this)" >' + '[' + data.data.agentSale[i].saleNumber + ']' + data.data.agentSale[i].saleName + '</div>'
                        }
                        document.getElementById('searchBox1').innerHTML = str


                    } else {
                        layer.msg(data.msg)
                        $('#searchBox1').hide()

                    }
                },
                function(data) {
                    console.log('222')
                }
            )
        })
        //模糊查询支行
        $("#openingBankBranch").bind('input propertychange', function() {
            console.log(this.value)
            if ($('#openingBank').val() == '') {
                layer.msg('请先选择开户银行')
                return
            }
            $('#openingBankBranch').removeAttr('openingBankNumber')

            document.getElementById('searchBox2').innerHTML = ''
            CmsUtility.postAjaxCall2(
                //系统设置
                commonServer + 'cache/getBank', {
                    "bankCode": $('#openingBank').val().split('|')[0],
                    "paymentType": '4',
                    "bankName": $('#openingBankBranch').val(),
                    "page": 1,
                    "limit": '100',
                    "provNm": $('#prov1').val().split('|')[1],
                    "cityNm": $('#city1').val().split('|')[1],
                },
                function(data) {
                    console.log(this.value)
                    if (data.code == 1000) {

                        var str = ''
                        for (var i = 0; i < data.data.selectBank.length; i++) {
                            str += '<div class="layui-btn layui-btn-primary" data-id="' + data.data.selectBank[i].lbnkNo + '" data-name="' + data.data.selectBank[i].lbnkNm + '" style="width:100%;margin-left:0" onclick="clickS2(this)" >' + data.data.selectBank[i].lbnkNm + '</div>'
                        }
                        document.getElementById('searchBox2').innerHTML = str

                        // layer.msg('保存成功')
                        // setTimeout(function(){
                        //  x_admin_close()
                        // },500);

                    } else {
                        layer.msg(data.msg)
                        $('#searchBox1').hide()

                    }
                },
                function(data) {
                    console.log('222')
                }
            )
        })
        CmsUtility.postAjaxCall2(
            //系统设置
            commonServer + 'cache/getOperationIds', {
                "institutionNumber": userNumber,
                "paymentType": 4
            },
            function(data) {
                operlist = data.data
                for (var i = 0; i < operlist.length; i++) {
                    var ob1 = new Object()
                    var ob2 = new Object()

                    var ob2List = new Array()
                    ob1.name = operlist[i].supMccNm
                    ob1.id = operlist[i].supMccCd
                    ob2.parId = operlist[i].supMccCd
                    operlistOne.push(ob1)
                    for (var j = 0; j < operlist[i].list.length; j++) {
                        var ob3 = new Object()
                        var ob4 = new Object()
                        var ob4List = new Array()
                        ob3.name = operlist[i].list[j].MccTypeNm
                        ob3.id = operlist[i].list[j].MccType
                        ob4.parId = operlist[i].list[j].MccType
                        ob2List.push(ob3)
                        var operlistThrList = operlist[i].list[j].ids
                        for (var k = 0; k < operlistThrList.length; k++) {
                            var ob5 = new Object()
                            ob5.name = operlistThrList[k].MccNm
                            ob5.id = operlistThrList[k].MccCd
                            ob4List.push(ob5)
                        }
                        ob4.childList = ob4List
                        operlistThr.push(ob4)
                    }
                    ob2.childList = ob2List
                    operlistTwo.push(ob2)
                }
                var str = ''
                for (var i = 0; i < operlistOne.length; i++) {
                    str += "<option value=" + operlistOne[i].id + " >" + operlistOne[i].name + "</option>"
                }
                $('#chOne').html(str)
                var str1 = ''
                for (var j = 0; j < operlistTwo[0].childList.length; j++) {
                    str1 += "<option value=" + operlistTwo[0].childList[j].id + " >" + operlistTwo[0].childList[j].name + "</option>"
                }
                $('#chTwo').html(str1)
                var str2 = ''
                for (var j = 0; j < operlistThr[0].childList.length; j++) {
                    str2 += "<option value=" + operlistThr[0].childList[j].id + " >" + operlistThr[0].childList[j].name + "</option>"
                }
                $('#chThr').html(str2)
                form.render()
            },
            function(data) {

            }, 'post', 'true'
        )
        form.on('select(chOne)', function(data) {
            console.log(data.value)
            var str = ''
            var str1 = ''
            var childId
            for (var i = 0; i < operlistTwo.length; i++) {
                if (operlistTwo[i].parId == data.value) {
                    childId = operlistTwo[i].childList[0].id
                    for (var j = 0; j < operlistTwo[i].childList.length; j++) {

                        str += "<option value=" + operlistTwo[i].childList[j].id + " >" + operlistTwo[i].childList[j].name + "</option>"
                    }
                }
            }
            console.log(childId)
            for (var k = 0; k < operlistThr.length; k++) {
                if (operlistThr[k].parId == childId) {
                    for (var h = 0; h < operlistThr[k].childList.length; h++) {

                        str1 += "<option value=" + operlistThr[k].childList[h].id + " >" + operlistThr[k].childList[h].name + "</option>"
                    }
                }
            }
            $('#chTwo').html(str)
            $('#chThr').html(str1)
            form.render()
        })
        form.on('select(chTwo)', function(data) {
            console.log(data.value)
            var str = ''
            for (var k = 0; k < operlistThr.length; k++) {
                if (operlistThr[k].parId == data.value) {
                    for (var h = 0; h < operlistThr[k].childList.length; h++) {

                        str += "<option value=" + operlistThr[k].childList[h].id + " >" + operlistThr[k].childList[h].name + "</option>"
                    }
                }
            }
            $('#chThr').html(str)
            form.render()

        })

        $('#addressTips').mouseover(function() {
            var that = this;
            layer.tips('填写门店实际经营地址，详细到XX路XX号。', that, {
                tips: [2],
                time: 20000
            });
        })
        $('#addressTips').mouseout(function() {
            layer.closeAll()
        })
        $('#merchantNameTips').mouseover(function() {
            var that = this;
            layer.tips(
                '注：商户名称，包括商户全称和商户简称，填写规范如下：商户所属行业合法，禁止入网的行业包括：广告、棋牌类、基金、理财 、套现、信用卡、传销等。商户名称中，不得包括以下敏感词汇：藏独、法轮功、色情、毒品、赌博、博彩、基金、理财、担保、贷款、集资、P2P、麻醉、间谍服务、私人侦探、股权、众筹、乐刷、套现、自选、千万户、000、T0、信用卡、担保、资金、淘宝、财务、收款、超时、商圈、金服、资产管理、微盘。',
                that, {
                    tips: [2],
                    time: 20000
                });
        })
        $('#merchantNameTips').mouseout(function() {
            layer.closeAll()
        })

        $('#alitTips').mouseover(function() {
            var that = this;
            layer.tips('支付宝账号为登录时的手机号或者邮箱号！', that, {
                tips: [2],
                time: 20000
            });
        })
        $('#alitTips').mouseout(function() {
            layer.closeAll()
        })
        $('#wechatTips').mouseover(function() {
            var that = this;
            layer.tips(
                '请填写商户联系人微信信息,微信要求已绑定银行卡完成实名认证，且实名的姓名与所填写的联系人姓名一致，微信号：需打开微信，在 "个人信息" 中看到的 "微信号",如 "微信号" 一栏显示 "未设置"，需先进行设置',
                that, {
                    tips: [2],
                    time: 20000
                });
        })
        $('#wechatTips').mouseout(function() {
            layer.closeAll()
        })
        $('#phoneTips').mouseover(function() {
            var that = this;
            layer.tips('该手机号做为商户登录时用，密码默认为后六位', that, {
                tips: [2],
                time: 20000
            });
        })
        $('#phoneTips').mouseout(function() {
            layer.closeAll()
        })
        $('#unionPayRate').mouseover(function() {
            var that = this;
            layer.tips('该费率为单笔交易1000以内包含1000的费率,建议费率0.23-0.6之间', that, {
                tips: [2],
                time: 20000
            });
        })
        $('#unionPayRate').mouseout(function() {
            layer.closeAll()
        })
        $('#unionPayRate2').mouseover(function() {
            var that = this;
            layer.tips('该费率为单笔交易金额大于1000的费率,建议费率0.53-0.1之间', that, {
                tips: [2],
                time: 20000
            });
        })
        $('#unionPayRate2').mouseout(function() {
            layer.closeAll()
        })
        $('#zfbRate').mouseover(function() {
            var that = this;
            layer.tips('支付宝及微信费率,建议费率0.20-0.60之间', that, {
                tips: [2],
                time: 20000
            });
        })
        $('#zfbRate').mouseout(function() {
            layer.closeAll()
        })
        CmsUtility.postAjaxCall2(
            //系统设置
            commonServer + 'cache/getAreajson02', {
                // "institutionNumber": userNumber,
                // "paymentType": 4
            },
            function(data) {
                citylist = data.data
                for (var i = 0; i < citylist.length; i++) {
                    var ob1 = new Object()
                    var ob2 = new Object()

                    var ob2List = new Array()
                    ob1.name = citylist[i].provName
                    ob1.id = citylist[i].provCode
                    ob2.parId = citylist[i].provCode
                    prov.push(ob1)
                    for (var j = 0; j < citylist[i].cityList.length; j++) {
                        var ob3 = new Object()
                        var ob4 = new Object()
                        var ob4List = new Array()
                        ob3.name = citylist[i].cityList[j].cityName
                        ob3.id = citylist[i].cityList[j].cityCode
                        ob4.parId = citylist[i].cityList[j].cityCode
                        ob2List.push(ob3)
                        var arealist = citylist[i].cityList[j].areaList
                        for (var k = 0; k < arealist.length; k++) {
                            var ob5 = new Object()
                            ob5.name = arealist[k].areaName
                            ob5.id = arealist[k].areaCode
                            ob4List.push(ob5)
                        }
                        ob4.childList = ob4List
                        area.push(ob4)
                    }
                    ob2.childList = ob2List
                    city.push(ob2)
                }
                var str = ''
                for (var i = 0; i < prov.length; i++) {
                    str += "<option value=" + prov[i].id + '|' + prov[i].name + " >" + prov[i].name + "</option>"
                }
                $('#prov').html(str)
                $('#prov1').html(str)
                // console.log(operlistTwo)
                var str1 = ''
                for (var j = 0; j < city[0].childList.length; j++) {
                    str1 += "<option value=" + city[0].childList[j].id + '|' + city[0].childList[j].name + " >" + city[0].childList[j].name + "</option>"
                }
                $('#city').html(str1)
                $('#city1').html(str1)
                var str2 = ''
                for (var j = 0; j < area[0].childList.length; j++) {
                    str2 += "<option value=" + area[0].childList[j].id + '|' + area[0].childList[j].name + " >" + area[0].childList[j].name + "</option>"
                }
                $('#area').html(str2)
                form.render()
            },
            function(data) {

            }, 'post', 'false'
        )
        form.on('select(prov)', function(data) {
            console.log(data.value)
            var str = ''
            var str1 = ''
            var childId
            for (var i = 0; i < city.length; i++) {
                if (city[i].parId == data.value.split('|')[0]) {
                    childId = city[i].childList[0].id
                    for (var j = 0; j < city[i].childList.length; j++) {

                        str += "<option value=" + city[i].childList[j].id + '|' + city[i].childList[j].name + " >" + city[i].childList[j].name + "</option>"
                    }
                }
            }
            console.log(childId)
            for (var k = 0; k < area.length; k++) {
                if (area[k].parId == childId) {
                    for (var h = 0; h < area[k].childList.length; h++) {

                        str1 += "<option value=" + area[k].childList[h].id + '|' + area[k].childList[h].name + " >" + area[k].childList[h].name + "</option>"
                    }
                }
            }
            $('#city').html(str)
            $('#area').html(str1)
            form.render()
        })
        form.on('select(prov1)', function(data) {
            console.log(data.value)
            var str = ''
            var str1 = ''
            var childId
            for (var i = 0; i < city.length; i++) {
                if (city[i].parId == data.value.split('|')[0]) {
                    childId = city[i].childList[0].id
                    for (var j = 0; j < city[i].childList.length; j++) {

                        str += "<option value=" + city[i].childList[j].id + '|' + city[i].childList[j].name + " >" + city[i].childList[j].name + "</option>"
                    }
                }
            }
            $('#city1').html(str)
            form.render()
        })
        form.on('select(city)', function(data) {
            console.log(data.value)
            var str = ''
            for (var k = 0; k < area.length; k++) {
                if (area[k].parId == data.value.split('|')[0]) {
                    for (var h = 0; h < area[k].childList.length; h++) {

                        str += "<option value=" + area[k].childList[h].id + " >" + area[k].childList[h].name + "</option>"
                    }
                }
            }
            $('#area').html(str)
            form.render()

        })
        laydate.render({
            elem: '#businessLicenseTime' //指定元素
        });
        laydate.render({
            elem: '#businessLicenseEndTime' //指定元素
        });
        laydate.render({
            elem: '#juridicalpersonIdTime' //指定元素
        });
        laydate.render({
            elem: '#juridicalPersonIDEndTime' //指定元素
        });
        laydate.render({
            elem: '#acntArtifidStartTime' //指定元素
        });
        laydate.render({
            elem: '#acntArtifidTime' //指定元素
        });
        farenBox()
        form.on('radio(cardvalid)', function(data) { //设置会员卡的有效期
            $('#farenxuanze').hide()
            legalFlag = 0
            acntType = '对私'
            $('.feifaren').hide()
            $('.kaihu').hide()
            $('.yinhangka').show()
            farenBox()
            if (data.value == 0) {
                $('.noGeren').hide()
                $('.geren').show()
                $('.qiye').hide()
                $('.noQiye').show()
                merType = 0
            } else if (data.value == 1) {
                $('.noGeren').show()
                $('.geren').hide()
                $('.qiye').hide()
                $('.noQiye').show()
                $('#farenxuanze').show()
                merType = 1
            } else if (data.value == 2) {
                $('.noGeren').show()
                $('.geren').hide()
                $('.qiye').show()
                $('.noQiye').hide()
                merType = 2
                $('#farenxuanze').show()
            }
            isAcnt()
        });

         form.on('radio(acntType)', function(data) { //设置会员卡的有效期
            console.log(data)
            if(data.value == 0 && acntType == '对私'){
                return 
            }
            if(data.value == 1 && acntType == '对公'){
                return 
            }
            farenBox()
            form.render()
            if (data.value == 0) {
               
                if(merType != 0){
                    $('#farenxuanze').show()
                }
                
                acntType = '对私'
                $('.kaihu').hide()
                $('.yinhangka').show()
            } else {
                
                $('#farenxuanze').hide()
                acntType = '对公'
                legalFlag = 0
                $('.kaihu').show()
                $('.yinhangka').hide()
                $('.feifaren').hide()
            }
        });
        form.on('radio(legalFlag)', function(data) { //设置会员卡的有效期
            legalFlag = data.value
            if (legalFlag == 0) {
                $('.feifaren').hide()
            } else {
                $('.feifaren').show()
            }
        });
        window.fileup = function(img, name, type) {

            var form = document.forms[0];
            var formData = new FormData();
            formData.append("file", dataURLtoFile(img, "123.png"));
            formData.append("institutionNumber", userNumber);
            formData.append("longTime", !orderNumber ? longTime : orderNumber);
            formData.append("type", type);
            $.ajax({
                // url: 'https://nb.51shanhe.com/shanhe-admin/InsMer/uploadMerchantImg',
                url: server + 'InsMer/uploadMerchantImg',
                type: 'POST',
                data: formData,
                async: false,
                cache: false,
                contentType: false, // 告诉jQuery不要去设置Content-Type请求头  
                processData: false, // 告诉jQuery不要去处理发送的数据
                success: function(returndata) {
                    layer.closeAll()
                    var timeStr = new Date().getTime()
                    $('#' + name).attr('src', returndata.data + '?time=' + timeStr); //图片链接（base64）

                    imgList[name] = returndata.data
                    if (type == 1) {
                        var aData = new Object()

                        aData.image = returndata.data
                        // aData.idCardSide = 'back'
                        aData.type = '1'
                        aData.appId = baidu.baiduAppID
                        aData.aipKey = baidu.baiduAPIKey
                        aData.aipToken = baidu.baiduSecretKey

                        $.ajax({
                            type: 'post',
                            url: 'http://api.51shanhe.com/p-server/appServer/getIdCard',
                            data: JSON.stringify(aData),
                            headers: {
                                'Content-Type': "application/json"
                            },
                            success: function(data) {
                                console.log(JSON.parse(data.data))
                                var data = JSON.parse(data.data)
                                layui.use(['upload', 'form'], function() {
                                    var $ = layui.jquery,
                                        upload = layui.upload,

                                        form = layui.form,
                                        layer = layui.layer;
                                    form.val('cardAdd', {
                                        "businessLicenseName": data.words_result.单位名称.words,
                                        "businessLicenseNo": data.words_result.社会信用代码.words,
                                        "businessLicenseTime": data.words_result.成立日期.words.replace('年', '-').replace('月', '-').replace('日', ''),
                                        "businessLicenseEndTime": data.words_result.有效期.words.replace('年', '-').replace('月', '-').replace('日', ''),
                                        "businessLicenseAddress": data.words_result.地址.words,
                                    })
                                })
                            }
                        })
                    } else if (type == 2) {
                        var aData = new Object()

                        aData.image = returndata.data
                        aData.idCardSide = 'front'
                        aData.type = '0'
                        aData.appId = baidu.baiduAppID
                        aData.aipKey = baidu.baiduAPIKey
                        aData.aipToken = baidu.baiduSecretKey

                        $.ajax({
                            type: 'post',
                            url: 'http://api.51shanhe.com/p-server/appServer/getIdCard',
                            data: JSON.stringify(aData),
                            headers: {
                                'Content-Type': "application/json"
                            },
                            success: function(data) {
                                console.log(JSON.parse(data.data))
                                var data = JSON.parse(data.data)
                                layui.use(['upload', 'form'], function() {
                                    var $ = layui.jquery,
                                        upload = layui.upload,

                                        form = layui.form,
                                        layer = layui.layer;
                                    form.val('cardAdd', {
                                        "juridicalpersonId": data.words_result.公民身份号码.words,
                                        "juridicalpersonName": data.words_result.姓名.words
                                    })


                                })

                            }
                        })
                    } else if (type == 3) {
                        var aData = new Object()

                        aData.image = returndata.data
                        aData.idCardSide = 'back'
                        aData.type = '0'
                        aData.appId = baidu.baiduAppID
                        aData.aipKey = baidu.baiduAPIKey
                        aData.aipToken = baidu.baiduSecretKey

                        $.ajax({
                            type: 'post',
                            url: 'http://api.51shanhe.com/p-server/appServer/getIdCard',
                            data: JSON.stringify(aData),
                            headers: {
                                'Content-Type': "application/json"
                            },
                            success: function(data) {
                                console.log(JSON.parse(data.data))
                                var data = JSON.parse(data.data)
                                layui.use(['upload', 'form'], function() {
                                    var $ = layui.jquery,
                                        upload = layui.upload,

                                        form = layui.form,
                                        layer = layui.layer;
                                    form.val('cardAdd', {
                                        "juridicalpersonIdTime": fourStr(data.words_result.签发日期.words),
                                        "juridicalPersonIDEndTime": fourStr(data.words_result.失效日期.words)
                                    })
                                })

                            }
                        })
                    } else if (type == 6) {
                        var aData = new Object()

                        aData.image = returndata.data
                        // aData.idCardSide = 'back'
                        aData.type = '2'
                        aData.appId = baidu.baiduAppID
                        aData.aipKey = baidu.baiduAPIKey
                        aData.aipToken = baidu.baiduSecretKey

                        $.ajax({
                            type: 'post',
                            url: 'http://api.51shanhe.com/p-server/appServer/getIdCard',
                            data: JSON.stringify(aData),
                            headers: {
                                'Content-Type': "application/json"
                            },
                            success: function(data) {
                                console.log(JSON.parse(data.data))
                                var data = JSON.parse(data.data)
                                layui.use(['upload', 'form'], function() {
                                    var $ = layui.jquery,
                                        upload = layui.upload,

                                        form = layui.form,
                                        layer = layui.layer;
                                    form.val('cardAdd', {
                                        "bankCardNo": data.result.bank_card_number.replace(/\s+/g, ''),

                                    })


                                })

                            }
                        })
                    } else if (type == 7) {
                        var aData = new Object()

                        aData.image = returndata.data
                        aData.idCardSide = 'front'
                        aData.type = '0'
                        aData.appId = baidu.baiduAppID
                        aData.aipKey = baidu.baiduAPIKey
                        aData.aipToken = baidu.baiduSecretKey

                        $.ajax({
                            type: 'post',
                            url: 'http://api.51shanhe.com/p-server/appServer/getIdCard',
                            data: JSON.stringify(aData),
                            headers: {
                                'Content-Type': "application/json"
                            },
                            success: function(data) {
                                console.log(JSON.parse(data.data))
                                var data = JSON.parse(data.data)
                                layui.use(['upload', 'form'], function() {
                                    var $ = layui.jquery,
                                        upload = layui.upload,

                                        form = layui.form,
                                        layer = layui.layer;
                                    form.val('cardAdd', {
                                        "settlementPersonID": data.words_result.公民身份号码.words,
                                        "settlementPersonName": data.words_result.姓名.words
                                    })


                                })

                            }
                        })
                    } else if (type == 8) {
                        var aData = new Object()

                        aData.image = returndata.data
                        aData.idCardSide = 'back'
                        aData.type = '0'
                        aData.appId = baidu.baiduAppID
                        aData.aipKey = baidu.baiduAPIKey
                        aData.aipToken = baidu.baiduSecretKey

                        $.ajax({
                            type: 'post',
                            url: 'http://api.51shanhe.com/p-server/appServer/getIdCard',
                            data: JSON.stringify(aData),
                            headers: {
                                'Content-Type': "application/json"
                            },
                            success: function(data) {
                                console.log(JSON.parse(data.data))
                                var data = JSON.parse(data.data)
                                layui.use(['upload', 'form'], function() {
                                    var $ = layui.jquery,
                                        upload = layui.upload,

                                        form = layui.form,
                                        layer = layui.layer;
                                    form.val('cardAdd', {
                                        "acntArtifidStartTime": fourStr(data.words_result.签发日期.words),
                                        "acntArtifidTime": fourStr(data.words_result.失效日期.words)
                                    })
                                })

                            }
                        })
                    }
                    layer.msg('上传成功');

                },
                error: function(returndata) {
                    layer.closeAll()

                }
            })
        }
        //营业执照
        $('#test1').click(function() {
            uploadImage('businessLicense', '1')
            console.log('123')

        })
        $('#businessLicense').click(function() {
            uploadImage('businessLicense', '1')
            console.log('123')

        })
        //收银台照
        $('#test2').click(function() {
            uploadImage('cashier', '13')
            console.log('123')

        })
        $('#cashier').click(function() {
            uploadImage('cashier', '13')
            console.log('123')

        })

        //场景照
        $('#test3').click(function() {
            uploadImage('placeBusiness', '14')
            console.log('123')

        })
        $('#placeBusiness').click(function() {
            uploadImage('placeBusiness', '14')
            console.log('123')

        })

        //门头照
        $('#test4').click(function() {
            uploadImage('doorheadPhoto', '5')
            console.log('123')

        })
        $('#doorheadPhoto').click(function() {
            uploadImage('doorheadPhoto', '5')
            console.log('123')

        })

        //身份证正面
        $('#test5').click(function() {
            uploadImage('juridicalpersonIdPositive', '2')
            console.log('123')

        })
        $('#juridicalpersonIdPositive').click(function() {
            uploadImage('juridicalpersonIdPositive', '2')
            console.log('123')

        })

        //身份证反面

        $('#test6').click(function() {
            uploadImage('juridicalpersonIdReverseside', '3')
            console.log('123')

        })
        $('#juridicalpersonIdReverseside').click(function() {
            uploadImage('juridicalpersonIdReverseside', '3')
            console.log('123')

        })



        //手持身份证
        $('#test7').click(function() {
            uploadImage('holdId', '11')
            console.log('123')

        })
        $('#holdId').click(function() {
            uploadImage('holdId', '11')
            console.log('123')

        })

        //开户许可证
        $('#test8').click(function() {
            uploadImage('openingPermit', '12')
            console.log('123')

        })
        $('#openingPermit').click(function() {
            uploadImage('openingPermit', '12')
            console.log('123')

        })

        //银行卡正面

        $('#test9').click(function() {
            uploadImage('bankCardPositive', '6')
            console.log('123')

        })
        $('#bankCardPositive').click(function() {
            uploadImage('bankCardPositive', '6')
            console.log('123')

        })


        //其他资料
        $('#test10').click(function() {
            uploadImage('rests', '16')
            console.log('123')

        })
        $('#rests').click(function() {
            uploadImage('rests', '16')
            console.log('123')

        })

        //结算人身份证正面


        $('#test11').click(function() {
            uploadImage('settlementPersonPositive', '7')
            console.log('123')

        })
        $('#settlementPersonPositive').click(function() {
            uploadImage('settlementPersonPositive', '7')
            console.log('123')

        })


        //结算人身份证反面
        $('#test12').click(function() {
            uploadImage('settlementPersonReverseside', '8')
            console.log('123')

        })
        $('#settlementPersonReverseside').click(function() {
            uploadImage('settlementPersonReverseside', '8')
            console.log('123')

        })


        //结算人手持身份证
        $('#test13').click(function() {
            uploadImage('holdId2', '20')
            console.log('123')

        })
        $('#holdId2').click(function() {
            uploadImage('holdId2', '20')
            console.log('123')

        })


        //结算授权书
        $('#test14').click(function() {
            uploadImage('letterOfAuthPic', '21')
            console.log('123')

        })
        $('#letterOfAuthPic').click(function() {
            uploadImage('letterOfAuthPic', '21')
            console.log('123')

        })


        //授权书合影
        $('#test15').click(function() {
            uploadImage('authorizationPhoto', '9')
            console.log('123')

        })
        $('#authorizationPhoto').click(function() {
            uploadImage('authorizationPhoto', '9')
            console.log('123')

        })

        //通道
        CmsUtility.postAjaxCall2(
            //系统设置
            server + 'InsMer/getInstitutionPayments', {
                "institutionNumber": userNumber,
            },
            function(data) {
                payList = data.data
                var str = ''
                // for (var k = 0; k < payList.length; k++) {

                //     if (payList[k].paymentType == 4 || payList[k].paymentType == 5) {
                //         str += '<input type="checkbox"   data-type=' + payList[k].paymentType + ' name="payment" value=' + payList[k].paymentChannel + '|' + payList[k].paymentType + ' title=' + payList[k].paymentChannelName + ' checked="">'
                //     } else {
                //         str += '<input type="checkbox"   data-type=' + payList[k].paymentType + ' name="payment" value=' + payList[k].paymentChannel + '|' + payList[k].paymentType + ' title=' + payList[k].paymentChannelName + '>'
                //     }


                // }
                // $('#paymentBox').html(str)
                // form.render()
            },
            function(data) {

            },
            'get', 'false'
        )

        form.on('switch(isOpenYunPay)', function(data) {
            if (this.checked == true) {

                isOpenYunPay = 0
                $('.ysfRate').show()
            } else {
                isOpenYunPay = 1
                $('.ysfRate').hide()
            }

        });
        form.on('switch(collegeFlage)', function(data) {
            if (this.checked == true) {

                collegeFlage = 0
            } else {
                collegeFlage = 1
            }

        });
        form.on('switch(businessLicenseType)', function(data) {
            if (this.checked == true) {
                $('.yyNoChangqi').hide()
                businessLicenseType = 0
            } else {
                $('.yyNoChangqi').show()
                businessLicenseType = 1
            }

        });
        form.on('switch(juridicalPersonIDType)', function(data) {
            if (this.checked == true) {
                $('.sfzNoChangqi').hide()
                juridicalPersonIDType = 0
            } else {
                $('.sfzNoChangqi').show()
                juridicalPersonIDType = 1
            }

        });
        form.on('switch(acntArtifIdType)', function(data) {
            if (this.checked == true) {
                $('.sfzNoChangqi1').hide()
                acntArtifIdType = 0
            } else {
                $('.sfzNoChangqi1').show()
                acntArtifIdType = 1
            }

        });
        //验证
        form.verify({
            title: function(value) {
                if (!value) {
                    return '必填项不能为空！';
                }
            },
            title1: function(value) {
                if (merType != 0) {
                    if (!value) {
                        return '必填项不能为空！';
                    }
                }
            },
            title2: function(value) {
                if (merType != 0 && businessLicenseType == 1) {
                    if (!value) {
                        return '必填项不能为空！';
                    }
                }
            },
            title3: function(value) {
                if (juridicalPersonIDType == 1) {
                    if (!value) {
                        return '必填项不能为空！';
                    }
                }
            },
            rate: function(value) {
                if (!value) {
                    return '必填项不能为空！'
                }
                if (isNaN(value) == true) {
                    return '请输入数字'
                }
                if (value < 0.21 || value > 1) {
                    return '费率需在0.21-1之间'
                }
            },
            unionPayRate: function(value) {
                if (isOpenYunPay == 0) {
                    if (!value) {
                        return '必填项不能为空！'
                    }
                    if (isNaN(value) == true) {
                        return '请输入数字'
                    }
                    if (value < 0.23 || value > 1) {
                        return '费率需在0.23-1之间'
                    }
                }

            },
            unionPayRate2: function(value) {
                if (isOpenYunPay == 0) {
                    if (!value) {

                        return '必填项不能为空！'
                    }
                    if (isNaN(value) == true) {
                        return '请输入数字'
                    }
                    if (value < 0.52 || value > 1) {
                        return '费率需在0.52-1之间'
                    }
                }

            },
            title4: function(value) {
                console.log(merType, legalFlag)
                if (merType == 2 && legalFlag == 1) {
                    console.log('123')
                    if (!value) {
                        return '必填项不能为空！'
                    }
                }
            },
            title5: function(value) {

                if (merType == 2 && legalFlag == 1 && acntArtifIdType == 1) {
                    if (!value) {
                        return '必填项不能为空！';
                    }
                }
            },
            title6: function(value) {
                if (merType == 2 && legalFlag == 1 && acntArtifIdType == 1) {
                    if (!value) {
                        return '必填项不能为空！';
                    }
                    if (!(/^1[3456789]\d{9}$/.test(value))) {
                        return '请填写正确的手机号';
                    }
                }
            }
        });
        var saleRate = new Object();

        function getSaleRate(saleNumber) {
            CmsUtility.postAjaxCall2(
                //系统设置
                CmsConfig.ServiceUrl.ApiRootUrl + 'agSale/getSaleInfoForNumber?saleNumber=' + saleNumber,
                '',
                function(data) {
                    if (data.code == 1000) {
                        saleRate.aliRate = data.data.aliRate
                        saleRate.unionPayRate = data.data.unionPayRate
                        saleRate.unionPayRate2 = data.data.unionPayRate
                        console.log(saleRate)

                    } else {


                    }
                },
                function(data) {
                    console.log('222')
                },
            )
        }
        var index = layer.load(2, { shade: [0.4, '#393D49'] })
        setTimeout(function() {
            CmsUtility.postAjaxCall2(
                //系统设置
                server + '/InsMer/getMerchantOrderInfo', {
                    "orderNumber": orderNumber,
                    "institutionNumber": JSON.parse(sessionStorage.getItem('saleUser')).institutionNumber
                },
                function(data) {
                    console.log(data)
                    layer.closeAll()
                    if (data.code == 1000) {

                        merInfo = data.data
                        paymentInfo = data.data.merchantPayments
                        imgList['businessLicense'] = merInfo.businessLicense || ''
                        imgList['cashier'] = merInfo.cashier || ''
                        imgList['placeBusiness'] = merInfo.placeBusiness || ''
                        imgList['doorheadPhoto'] = merInfo.doorheadPhoto || ''
                        imgList['juridicalpersonIdPositive'] = merInfo.juridicalpersonIdPositive || ''
                        imgList['juridicalpersonIdReverseside'] = merInfo.juridicalpersonIdReverseside || ''
                        imgList['holdId'] = merInfo.holdId || ''
                        imgList['openingPermit'] = merInfo.openingPermit || ''
                        imgList['bankCardPositive'] = merInfo.bankCardPositive || ''
                        //新增图片
                        imgList['rests'] = merInfo.rests || ''
                        imgList['settlementPersonPositive'] = merInfo.settlementPersonPositive || ''
                        imgList['settlementPersonReverseside'] = merInfo.settlementPersonReverseside || ''
                        imgList['holdId2'] = merInfo.holdId2 || ''
                        imgList['letterOfAuthPic'] = merInfo.letterOfAuthPic || ''


                        imgList['authorizationPhoto'] = merInfo.authorizationPhoto || ''


                        console.log(imgList)
                        businessLicense = imgList.businessLicense
                        cashier = imgList.cashier
                        placeBusiness = imgList.placeBusiness
                        doorheadPhoto = imgList.doorheadPhoto
                        juridicalpersonIdPositive = imgList.juridicalpersonIdPositive
                        juridicalpersonIdReverseside = imgList.juridicalpersonIdReverseside
                        holdId = imgList.holdId
                        openingPermit = imgList.openingPermit
                        bankCardPositive = imgList.bankCardPositive
                        rests = imgList.rests
                        settlementPersonPositive = imgList.settlementPersonPositive
                        settlementPersonReverseside = imgList.settlementPersonReverseside
                        holdId2 = imgList.holdId2
                        letterOfAuthPic = imgList.letterOfAuthPic
                        authorizationPhoto = imgList.authorizationPhoto

                        $('#businessLicense').attr('src', businessLicense)
                        $('#cashier').attr('src', cashier)
                        $('#placeBusiness').attr('src', placeBusiness)
                        $('#doorheadPhoto').attr('src', doorheadPhoto)
                        $('#juridicalpersonIdPositive').attr('src', juridicalpersonIdPositive)
                        $('#juridicalpersonIdReverseside').attr('src', juridicalpersonIdReverseside)
                        $('#holdId').attr('src', holdId)
                        $('#openingPermit').attr('src', openingPermit)
                        $('#bankCardPositive').attr('src', bankCardPositive)


                        $('#rests').attr('src', rests)
                        $('#settlementPersonPositive').attr('src', settlementPersonPositive)
                        $('#settlementPersonReverseside').attr('src', settlementPersonReverseside)
                        $('#holdId2').attr('src', holdId2)
                        $('#letterOfAuthPic').attr('src', letterOfAuthPic)
                        $('#authorizationPhoto').attr('src',authorizationPhoto)


                        merInfo.merchantType1 = merInfo.merchantType
                        legalFlag = merInfo.legalFlag
                        acntType = merInfo.acntType
                        $('.feifaren').hide()
                        $('.kaihu').hide()
                        $('.yinhangka').show()
                        $('#farenxuanze').hide()
                        farenBox()
                        if (merInfo.merchantType == '个人') {
                            merInfo.merchantTyp1 = '0'
                            $('.noGeren').hide()
                            $('.geren').show()
                            $('.qiye').hide()
                            $('.noQiye').show()
                            merType = 0
                        }
                        if (merInfo.merchantType == '个体') {
                            merInfo.merchantTyp1 = '1'
                            $('.noGeren').show()
                            $('.geren').hide()
                            $('.qiye').hide()
                            $('.noQiye').show()
                            merType = 1
                        }
                        if (merInfo.merchantType == '企业') {
                            merInfo.merchantTyp1 = '2'
                            $('.noGeren').show()
                            $('.geren').hide()
                            $('.qiye').show()
                            $('.noQiye').hide()
                            merType = 2
                            $('#farenxuanze').show()
                        }
                        if (legalFlag == 1 && acntType == '对私') {
                            $('.feifaren').show()
                        } else {
                            $('.feifaren').hide()
                        }
                         if (acntType == '对私') {
                            console.log(123)
                            if(merType != 0){
                                $('#farenxuanze').show()
                            }
                            $('.kaihu').hide()
                            $('.yinhangka').show()
                        } else {
                            $('#farenxuanze').hide()
                            console.log('456')
                            $('.kaihu').show()
                            $('.yinhangka').hide()
                        }

                        if (merInfo.isOpenYunPay == 0) {

                            isOpenYunPay = 0
                            $('.ysfRate').show()
                        } else {
                            isOpenYunPay = 1
                            $('.ysfRate').hide()
                        }
                        if (merInfo.businessLicenseType == 0) {
                            $('.yyNoChangqi').hide()
                            businessLicenseType = 0
                        } else {
                            $('.yyNoChangqi').show()
                            businessLicenseType = 1
                        }
                        if (merInfo.juridicalPersonIDType == 0) {
                            $('.sfzNoChangqi').hide()
                            juridicalPersonIDType = 0
                        } else {
                            $('.sfzNoChangqi').show()
                            juridicalPersonIDType = 1
                        }
                        if (merInfo.acntArtifIdType == 0) {
                            $('.sfzNoChangqi1').hide()
                            acntArtifIdType = 0
                        } else {
                            $('.sfzNoChangqi1').show()
                            acntArtifIdType = 1
                        }
                        var str, str1
                        for (var i = 0; i < operlistTwo.length; i++) {
                            if (operlistTwo[i].parId == merInfo.oneOperate) {

                                for (var j = 0; j < operlistTwo[i].childList.length; j++) {

                                    str += "<option value=" + operlistTwo[i].childList[j].id + " >" + operlistTwo[i].childList[j].name + "</option>"
                                }
                            }
                        }
                        for (var k = 0; k < operlistThr.length; k++) {
                            if (operlistThr[k].parId == merInfo.twoOperate) {
                                for (var h = 0; h < operlistThr[k].childList.length; h++) {

                                    str1 += "<option value=" + operlistThr[k].childList[h].id + " >" + operlistThr[k].childList[h].name + "</option>"
                                }
                            }
                        }
                        $('#chTwo').html(str)
                        $('#chThr').html(str1)
                        var strr = ''
                        for (var i = 0; i < prov.length; i++) {
                            if (prov[i].id == merInfo.provinceID) {
                                strr += "<option value=" + prov[i].id + '|' + prov[i].name + " selected >" + prov[i].name + "</option>"

                            } else {
                                strr += "<option value=" + prov[i].id + '|' + prov[i].name + " >" + prov[i].name + "</option>"
                            }

                        }
                        $('#prov').html(strr)
                        $('#prov1').html(strr)
                        var strr1 = ''
                        for (var j = 0; j < city.length; j++) {
                            if (city[j].parId == merInfo.provinceID) {
                                for (var k = 0; k < city[j].childList.length; k++) {
                                    if (city[j].childList[k].id == merInfo.cityID) {
                                        strr1 += "<option value=" + city[j].childList[k].id + '|' + city[j].childList[k].name + " selected >" + city[j].childList[k].name + "</option>"
                                    } else {
                                        strr1 += "<option value=" + city[j].childList[k].id + '|' + city[j].childList[k].name + " >" + city[j].childList[k].name + "</option>"
                                    }
                                }
                            }


                        }
                        $('#city').html(strr1)
                        $('#city1').html(strr1)
                        var strr2 = ''
                        for (var j = 0; j < area.length; j++) {
                            if (area[j].parId == merInfo.cityID) {
                                for (var k = 0; k < area[j].childList.length; k++) {
                                    if (area[j].childList[k].id == merInfo.areaID) {
                                        strr2 += "<option value=" + area[j].childList[k].id + '|' + area[j].childList[k].name + " selected>" + area[j].childList[k].name + "</option>"
                                    } else {
                                        strr2 += "<option value=" + area[j].childList[k].id + '|' + area[j].childList[k].name + " >" + area[j].childList[k].name + "</option>"
                                    }
                                }
                            }

                        }
                        $('#area').html(strr2)
                        $('#agName').val(merInfo.agentName)
                        $('#agName').attr('agentNumber', merInfo.agentNumber)
                        $('#slName').val(merInfo.saleName)
                        $('#slName').attr('saleNumber', merInfo.saleNumber)
                        getSaleRate(merInfo.saleNumber)
                        $('#openingBankBranch').val(merInfo.openingBankBranch)
                        $('#openingBankBranch').attr('openingBankName', merInfo.openingBankBranch)
                        $('#openingBankBranch').attr('openingBankNumber', merInfo.openingBankBranchID)
                        console.log($('#openingBankBranch').attr('openingBankName'))
                        console.log($('#openingBankBranch').attr('openingBankNumber'))
                        console.log(payList)
                        var pStr = ''
                        // for(var b = 0 ; b < payList.length;b++){
                        //     var type = 0
                        //     for(var v = 0 ; v < paymentInfo.length;v++){
                        //         if(paymentInfo[v].paymentChannel == payList[b].paymentChannel){
                        //             type = 1
                        //         }
                        //     }
                        //     if(type == 0){
                        //         pStr += '<input type="checkbox"   data-type=' + payList[b].paymentType + ' name="payment" value=' + payList[b].paymentChannel + '|' + payList[b].paymentType + ' title=' + payList[b].paymentChannelName + ' >'
                        //     }else{
                        //         pStr += '<input type="checkbox"   data-type=' + payList[b].paymentType + ' name="payment" value=' + payList[b].paymentChannel + '|' + payList[b].paymentType + ' title=' + payList[b].paymentChannelName + ' checked="">'
                        //     }
                        // }
                        // $('#paymentBox').html(pStr)
                        // form.render()
                        isAcnt()
                        collegeFlage = merInfo.collegeFlage
                        separateType = merInfo.separateType 
                        if (separateType == 0) {

                            $('.fanliBox').show()
                        } else {
                            $('.fanliBox').hide()
                        }
                        form.render()
                        form.val('cardAdd', {
                            "merchantType": merInfo.merchantType1,
                            "merchantAbbreviation": merInfo.merchantAbbreviation,
                            "merchantName": merInfo.merchantName,
                            "businessLicenseName": merInfo.businessLicenseName,
                            "oneOperate": merInfo.oneOperate,
                            "twoOperate": merInfo.twoOperate,
                            "threeOperate": merInfo.threeOperate,
                            "customerServiceTell": merInfo.customerServiceTell,
                            "rate": merInfo.rate > 0.1 ? merInfo.rate : (merInfo.rate * 100).toFixed(2),
                            "businessLicenseNo": merInfo.businessLicenseNo,
                            "businessLicenseTime": merInfo.businessLicenseTime,
                            "businessLicenseEndTime": merInfo.businessLicenseEndTime,
                            "businessLicenseAddress": merInfo.businessLicenseAddress,
                            "businessLicenseType": merInfo.businessLicenseType == 0 ? true : false,
                            "mailbox": merInfo.mailbox,
                            "isOpenYunPay": merInfo.isOpenYunPay == 0 ? true : false,
                            "collegeFlage": merInfo.collegeFlage == 0 ? true : false,
                            "address": merInfo.address,
                            "weChatNo": merInfo.weChatNo,
                            "aliPayNo": merInfo.aliPayNo,
                            "juridicalpersonId": merInfo.juridicalpersonId,
                            "juridicalpersonName": merInfo.juridicalpersonName,
                            "registerCell": merInfo.registerCell,
                            "juridicalpersonIdTime": merInfo.juridicalpersonIdTime,
                            "juridicalPersonIDEndTime": merInfo.juridicalPersonIDEndTime,
                            "juridicalPersonIDType": merInfo.juridicalPersonIDType == 0 ? true : false,

                            "bankCardNo": merInfo.bankCardNo,
                            "openingBank1": merInfo.openingBankID + '|' + merInfo.openingBank,

                            "openingBankBranchAddress": merInfo.openingBankBranchAddress,
                            "reserveCell": merInfo.reserveCell,
                            "msg": merInfo.msg,
                            "unionPayRate": (merInfo.unionPayRate * 100).toFixed(2),
                            "unionPayRate2": (merInfo.unionPayRate2 * 100).toFixed(2),
                            "acntType": merInfo.acntType == '对私' ? '0' : '1',
                            "legalFlag": merInfo.legalFlag,
                            "settlementPersonID": merInfo.settlementPersonID,
                            "settlementPersonName": merInfo.settlementPersonName,
                            "acntArtifidStartTime": merInfo.acntArtifidStartTime,
                            "acntArtifidTime": merInfo.acntArtifidTime,
                            "acntArtifIdType": merInfo.acntArtifIdType,
                            "rateType": merInfo.rateType == 'D1' ? true : false,
                            "acntArtifIdType": merInfo.acntArtifIdType == 0 ? true : false,
                            "fanli":merInfo.separateType == '0' ? true : false,
                            "separateRatio" :merInfo.separateRatio *100
                        })
                        if (merInfo.msg == null || merInfo.msg == '') {
                            $('#msg').hide()
                        } else {
                            $('#msg').show()
                        }
                        console.log(merInfo.qualifications)
                       if(merInfo.qualifications != null){
                            console.log(merInfo.qualifications)
                            var in1 = document.getElementsByTagName('input')
                            for(var i = 0 ; i < in1.length;i++){
                                in1[i].setAttribute('disabled','disabled')
                            }
                            
                        }
                        form.render()
                        layer.closeAll()

                    } else {

                        layer.msg(data.msg)
                    }
                },
                function(data) {

                }
            )
        }, 500)
        if(channelType == 4){
            $('.xdlneed').show()
        }else{
            $('.xdlneed').hide()
        }
        form.on('switch(isfanli)', function(data) {
            if (this.checked == true) {

                $('.fanliBox').show()
                separateType = 0
            } else {
                $('.fanliBox').hide()
                separateType = 1
            }

        });
        form.on('submit(add)', function(data, index) {
            console.log(imgList)
            cashier = imgList['cashier'] || ''
            placeBusiness = imgList['placeBusiness'] || ''
            doorheadPhoto = imgList['doorheadPhoto'] || ''
            juridicalpersonIdPositive = imgList['juridicalpersonIdPositive'] || ''
            juridicalpersonIdReverseside = imgList['juridicalpersonIdReverseside'] || ''
            bankCardPositive = imgList['bankCardPositive'] || ''
            businessLicense = imgList['businessLicense'] || ''
            openingPermit = imgList['openingPermit'] || ''
            holdId = imgList['holdId'] || ''
            //新增图片
            rests = imgList['rests'] || ''
            settlementPersonPositive = imgList['settlementPersonPositive'] || ''
            settlementPersonReverseside = imgList['settlementPersonReverseside'] || ''
            holdId2 = imgList['holdId2'] || ''
            letterOfAuthPic = imgList['letterOfAuthPic'] || ''
            authorizationPhoto = imgList['authorizationPhoto'] || ''
            if (cashier == '' || placeBusiness == '' || doorheadPhoto == '' || juridicalpersonIdPositive == '' ||
                juridicalpersonIdReverseside == '') {

                layer.msg('请补充图片信息')
                return false
            }
            if (merType != 0) {
                if (businessLicense == '') {
                    layer.msg('请补充图片信息')
                    return false
                }
            }
            if (merType == 2) {
                if (acntType == '对私') {
                    if (bankCardPositive == '') {
                        layer.msg('请补充银行卡图片信息')
                        return false
                    }
                }
                if (acntType == '对公') {
                    if (openingPermit == '') {
                        layer.msg('请补充开户许可证图片信息')
                        return false
                    }
                }


            }
            if (merType == 0) {
                if (holdId == '') {
                    layer.msg('请补充图片信息')
                    return false
                }
            }
            if (merType != 2) {
                if (bankCardPositive == '') {
                    layer.msg('请补充图片信息')
                    return false
                }
            }
            if (legalFlag == 1) {
                if (settlementPersonPositive == '' || settlementPersonReverseside == ''  || letterOfAuthPic == '') {
                    layer.msg('请补充非法人结算相关图片信息')
                    return false
                }
            }
            if(channelType == 4 && legalFlag == 1){
                
                 if (authorizationPhoto == '') {
                    layer.msg('请补充授权书合影图片')
                    return false
                }
            }
            // var arr = new Array();
            // $("input:checkbox[name='payment']:checked").each(function(i) {
            //     arr[i] = $(this).val();
            // });
            // console.log(arr)
            // var pyList = []
            // for (var j = 0; j < arr.length; j++) {
            //     var pb = new Object()
            //     pb.paymentType = arr[j].split('|')[1]
            //     pb.paymentChannel = arr[j].split('|')[0]
            //     pyList.push(pb)
            // }
            var tjData = data.field
            tjData.institutionNumber = userNumber
            tjData.agentNumber = JSON.parse(sessionStorage.getItem('saleUser')).agentNumber
            tjData.saleNumber = JSON.parse(sessionStorage.getItem('saleUser')).Number

            tjData.businessLicense = isWen(businessLicense)
            tjData.cashier = isWen(cashier)
            tjData.placeBusiness = isWen(placeBusiness)
            tjData.doorheadPhoto = isWen(doorheadPhoto)
            tjData.facePhoto = isWen(doorheadPhoto)
            tjData.juridicalpersonIdPositive = isWen(juridicalpersonIdPositive)
            tjData.juridicalpersonIdReverseside = isWen(juridicalpersonIdReverseside)
            tjData.holdId = isWen(holdId)
            tjData.openingPermit = isWen(openingPermit)
            tjData.bankCardPositive = isWen(bankCardPositive)
            tjData.rests = isWen(rests)
            tjData.settlementPersonPositive = isWen(settlementPersonPositive)
            tjData.settlementPersonReverseside = isWen(settlementPersonReverseside)
            tjData.holdId2 = isWen(holdId2)
            tjData.bankCardPositive = isWen(bankCardPositive)
            tjData.letterOfAuthPic = isWen(letterOfAuthPic)
            tjData.authorizationPhoto = isWen(authorizationPhoto)
            tjData.longTime = longTime
            if (tjData.merchantType == '个人') {
                tjData.merchantType = '个人'
            }
            if (tjData.merchantType == '个体') {
                tjData.merchantType = '个体'
            }
            if (tjData.merchantType == '企业') {
                tjData.merchantType = '企业'
            }
            tjData.acntType = acntType
            if (!$('#openingBankBranch').attr('openingBankNumber')) {
                layer.msg('请选择支行')
                return
            }
            if (juridicalPersonIDType == 1) {
                var oDate1 = new Date(tjData.juridicalpersonIdTime)
                var oDate2 = new Date(tjData.juridicalPersonIDEndTime)
                console.log(oDate1, oDate2)
                if (oDate1.getTime() >= oDate2.getTime()) {
                    layer.msg('身份证有效期开始时间不得大于或等于结束时间')
                    return
                }
            }
            if (channelType == '0' ) {
                if (tjData.aliPayNo == '') {
                    layer.msg('选择官方通道必须输入支付宝账号')
                    return
                }
            }
            tjData.paymentType = channelType
            tjData.paymentChannel = channel
            tjData.juridicalPersonIDType = juridicalPersonIDType
            tjData.businessLicenseType = businessLicenseType
            tjData.operationId = data.field.threeOperate
            tjData.province = tjData.prov1.split('|')[1]
            tjData.provinceID = tjData.prov1.split('|')[0]
            tjData.city = tjData.city1.split('|')[1]
            tjData.cityID = tjData.city1.split('|')[0]
            tjData.area = tjData.area1.split('|')[1]
            tjData.areaID = tjData.area1.split('|')[0]
            console.log(tjData)
            tjData.isOpenYunPay = isOpenYunPay
            // tjData.paymentChannels = JSON.stringify(pyList)
            tjData.subsidy = 1
            tjData.openingBank = tjData.openingBank1.split('|')[1]
            tjData.openingBankID = tjData.openingBank1.split('|')[0]
            tjData.openingBankBranch = $('#openingBankBranch').attr('openingBankName')
            tjData.openingBankBranchID = $('#openingBankBranch').attr('openingBankNumber')
            tjData.merchantNumber = merchantNumber
            tjData.orderNumber = orderNumber
            tjData.customerServiceTell = tjData.registerCell
            if (legalFlag == 0) {
                tjData.reserveCell = tjData.registerCell
            }
            tjData.rate = (tjData.rate / 100).toFixed(4)
            tjData.unionPayRate = (tjData.unionPayRate / 100).toFixed(4)
            tjData.unionPayRate2 = (tjData.unionPayRate2 / 100).toFixed(4)
            //5.11后新加参数
            tjData.rateType = rateType
            tjData.acntArtifIdType = acntArtifIdType
             // 高校标识
            tjData.collegeFlage = collegeFlage
            if (tjData.rate < saleRate.aliRate && saleRate.aliRate != 0) {
                layer.msg('费率低于该销售费率，请重新填写')
                return false
            }
            if (tjData.isOpenYunPay == 0) {
                if (tjData.unionPayRate < saleRate.unionPayRate && saleRate.unionPayRate != 0) {
                    layer.msg('云闪付费率1低于该销售费率，请重新填写')
                    return false
                }
                if (tjData.unionPayRate2 < saleRate.unionPayRate2 && saleRate.unionPayRate2 != 0) {
                    layer.msg('云闪付费率2低于该销售费率，请重新填写')
                    return false
                }
            }
            // 返利信息
                if(separateType == 0){
                    if(tjData.separateRatio > 30){
                        layer.msg('返利最大不得超过30%')
                        return  false
                    }
                    tjData.separateRatio = tjData.separateRatio /100
                    
                    tjData.separateType = separateType
                }
            var tipStr = ''
            tipStr += '商户名称：' + tjData.merchantName + '</br>'
            tipStr += '注册手机号：' + tjData.registerCell + '</br>'
            tipStr += '微信/支付宝费率:' + (tjData.rate * 100).toFixed(2) + '%' + '</br>'
            if (isOpenYunPay == 0) {
                tipStr += '云闪付费率(单笔1000以下)：' + (tjData.unionPayRate * 100).toFixed(2) + '%' + '</br>'
                tipStr += '云闪付费率(单笔1000以上)：' + (tjData.unionPayRate2 * 100).toFixed(2) + '%' + '</br>'
            } else {
                tipStr += '云闪付费率(单笔1000以下)：' + '未开通' + '</br>'
                tipStr += '云闪付费率(单笔1000以上)：' + '未开通' + '</br>'
            }
            layer.confirm(tipStr, { icon: 0, title: '商户信息!' }, function(index) {
                var index = layer.load(2, {
                    shade: [0.4, '#393D49']
                })
                console.log(tjData)
                CmsUtility.postAjaxCall2(
                    //系统设置
                    server + 'InsMer/updateMerchantOrderInfo',
                    tjData,
                    function(data) {
                        console.log(data)
                        layer.closeAll()
                        if (data.code == 1000) {
                            setTimeout(function() {
                                x_admin_close()
                                parent.layer.msg('服务成功')
                                window.parent.location.reload()
                            })
                        } else {
                            layer.msg(data.msg)
                        }
                    },
                    function(data) {

                    }
                )
                return false;

            })

        });
    })
    </script>
</body>

</html>