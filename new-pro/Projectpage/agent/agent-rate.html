<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title></title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" href="../../public/css/xadmin.css">
    <script type="text/javascript" src="../../public/js/jquery-3.2.1.js"></script>
    <script type="text/javascript" src="../../public/lib/layui/layui.js" charset="utf-8"></script>
    <script type="text/javascript" src="../../public/js/xadmin.js"></script>
    <script type="text/javascript" src="../../public/js/tableSelect.js"></script>
    <script type="text/javascript" src="../../public/js/data.js"></script>
    <!-- 让IE8/9支持媒体查询，从而兼容栅格 -->
    <!--[if lt IE 9]>
      <script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
      <script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style>
        .widthauto {
                width: auto !important;
            }
            
            .tips_red {
                color: red;
            }
            
            .layui-form-label {
                padding-left: 0;
                width: 120px;
            }
            
            .layui-input-block {
                margin-left: 115px;
            }
            
            .layui-elem-quote {
                font-size: 18px;
            }
            
            .layui-elem-field {
                margin: 0;
            }
            
            .layui-elem-field legend {
                font-size: 16px;
                margin-bottom: 15px;
            }
            
            .layui-upload-img {
                width: 92px;
                height: 92px;
                margin: 0 10px 10px 0;
            }
            
            .Since_inline {
                display: inline-block;
                width: auto !important;
                line-height: 38px;
            }
            
            .layui-elem-quote .layui-form-switch {
                margin: 0 15px;
                margin-top: 0;
            }
            .layui-form-item .layui-input-inline{
                width: 135px;
            }
            /* .layui-form-item .layui-input-inline{
                width: 80px;
            } */
            #suozaidi  .layui-input-inline{
                width: 190px;
            }
            .nowHide{
                display: none;
            }
        </style>
</head>

<body id="iosiframe">
    <div class="x-body">
        <div class="layui-row">
            <div class="layui-form" action="" lay-filter="cardAdd">
                <blockquote class="layui-elem-quote">费率设置(费率单位为百分比，示例：0.38%)</blockquote>
                <div class="layui-form-item">
                    <div class="layui-input-item">
                        <span style="color:red;display:block;margin-left:30px">*云闪付费率1为单笔1000以内包括1000所设置</span>
                    </div>
                    <div class="layui-input-item">
                        <span style="color:red;display:block;margin-left:30px">*云闪付费率2为单笔1000以上所设置</span>
                    </div>
                </div>
                <fieldset class="layui-elem-field layui-field-title alipay" style="display:none">
                    <legend>官方支付宝</legend>
                    <div class="layui-form-item">
                        <label class="layui-form-label">支付宝费率(%)</label>
                        <div class="layui-input-inline">
                            <input type="text" name="gfAliRate" lay-verify="baifenbi" autocomplete="off" placeholder="请输入费率" class="layui-input" value="0.30">
                        </div>
                    </div>
                </fieldset>
                <fieldset class="layui-elem-field layui-field-title wechatpay" style="display:none">
                    <legend>官方微信</legend>
                    <div class="layui-form-item">
                        <label class="layui-form-label">微信费率(%)</label>
                        <div class="layui-input-inline">
                            <input type="text" name="gfWeChatRate" lay-verify="baifenbi" autocomplete="off" placeholder="请输入费率" class="layui-input" value="0.30">
                        </div>
                    </div>
                </fieldset>
                <fieldset class="layui-elem-field layui-field-title fuyou" style="display:none">
                    <legend>富友通道</legend>
                    <div class="layui-form-item">
                        <div class="layui-inline">
                            <label class="layui-form-label">微信费率(%)</label>
                            <div class="layui-input-inline">
                                <input type="text" name="fyweChatRate" lay-verify="baifenbi" autocomplete="off" placeholder="请输入费率" class="layui-input" value="0.30">
                            </div>
                        </div>
                        <div class="layui-inline">
                            <label class="layui-form-label">支付宝费率(%)</label>
                            <div class="layui-input-inline">
                                <input type="text" name="fyaliRate" lay-verify="baifenbi" autocomplete="off" placeholder="请输入费率" class="layui-input" value="0.30">
                            </div>
                        </div>
                        <div class="layui-inline">
                            <label class="layui-form-label">云闪付费率1(%)</label>
                            <div class="layui-input-inline">
                                <input type="text" name="fyUnionPayRate" lay-verify="baifenbi" autocomplete="off" placeholder="请输入费率" class="layui-input" value="0.30">
                            </div>
                        </div>
                        <div class="layui-inline">
                            <label class="layui-form-label">云闪付费率2(%)</label>
                            <div class="layui-input-inline">
                                <input type="text" name="fyUnionPayRatetwo" lay-verify="baifenbi" autocomplete="off" placeholder="请输入费率" class="layui-input" value="0.30">
                            </div>
                        </div>
                        <div class="layui-inline  nowHide">
                            <label class="layui-form-label">京东钱包费率(%)</label>
                            <div class="layui-input-inline">
                                <input type="text" name="fyJDWallet" lay-verify="baifenbi" autocomplete="off" placeholder="请输入费率" class="layui-input" value="0.30">
                            </div>
                        </div>
                        <div class="layui-inline  nowHide">
                            <label class="layui-form-label">qq钱包费率(%)</label>
                            <div class="layui-input-inline">
                                <input type="text" name="fyQQWallet" lay-verify="baifenbi" autocomplete="off" placeholder="请输入费率" class="layui-input" value="0.30">
                            </div>
                        </div>
                        <div class="layui-inline  nowHide">
                            <label class="layui-form-label">翼支付费率(%)</label>
                            <div class="layui-input-inline">
                                <input type="text" name="fyWingPayRate" lay-verify="baifenbi" autocomplete="off" placeholder="请输入费率" class="layui-input" value="0.30">
                            </div>
                        </div>
                    </div>
                </fieldset>
                <fieldset class="layui-elem-field layui-field-title xdl" style="display:none">
                    <legend>新大陆通道</legend>
                    <div class="layui-form-item">
                        <div class="layui-inline">
                            <label class="layui-form-label">微信费率(%)</label>
                            <div class="layui-input-inline">
                                <input type="text" name="xdlweChatRate" lay-verify="baifenbi" autocomplete="off" placeholder="请输入费率" class="layui-input" value="0.30">
                            </div>
                        </div>
                        <div class="layui-inline">
                            <label class="layui-form-label">支付宝费率(%)</label>
                            <div class="layui-input-inline">
                                <input type="text" name="xdlaliRate" lay-verify="baifenbi" autocomplete="off" placeholder="请输入费率" class="layui-input" value="0.30">
                            </div>
                        </div>
                        <div class="layui-inline">
                            <label class="layui-form-label">云闪付费率1(%)</label>
                            <div class="layui-input-inline">
                                <input type="text" name="xdlUnionPayRate" lay-verify="baifenbi" autocomplete="off" placeholder="请输入费率" class="layui-input" value="0.30">
                            </div>
                        </div>
                        <div class="layui-inline">
                            <label class="layui-form-label">云闪付费率2(%)</label>
                            <div class="layui-input-inline">
                                <input type="text" name="XdlUnionPayRatetwo" lay-verify="baifenbi" autocomplete="off" placeholder="请输入费率" class="layui-input" value="0.30">
                            </div>
                        </div>
                        <div class="layui-inline  nowHide">
                            <label class="layui-form-label">京东钱包费率(%)</label>
                            <div class="layui-input-inline">
                                <input type="text" name="xdlJDWallet" lay-verify="baifenbi" autocomplete="off" placeholder="请输入费率" class="layui-input" value="0.30">
                            </div>
                        </div>
                        <div class="layui-inline  nowHide">
                            <label class="layui-form-label">qq钱包费率(%)</label>
                            <div class="layui-input-inline">
                                <input type="text" name="xdlQQWallet" lay-verify="baifenbi" autocomplete="off" placeholder="请输入费率" class="layui-input" value="0.30">
                            </div>
                        </div>
                        <div class="layui-inline  nowHide">
                            <label class="layui-form-label">翼支付费率(%)</label>
                            <div class="layui-input-inline">
                                <input type="text" name="xdlWingPayRate" lay-verify="baifenbi" autocomplete="off" placeholder="请输入费率" class="layui-input" value="0.30">
                            </div>
                        </div>
                    </div>
                </fieldset>
                <fieldset class="layui-elem-field layui-field-title sxf" style="display:none">
                    <legend>随行付通道</legend>
                    <div class="layui-form-item">
                        <div class="layui-inline">
                            <label class="layui-form-label">微信费率(%)</label>
                            <div class="layui-input-inline">
                                <input type="text" name="sxfweChatRate" lay-verify="baifenbi" autocomplete="off" placeholder="请输入费率" class="layui-input" value="0.30">
                            </div>
                        </div>
                        <div class="layui-inline">
                            <label class="layui-form-label">支付宝费率(%)</label>
                            <div class="layui-input-inline">
                                <input type="text" name="sxfaliRate" lay-verify="baifenbi" autocomplete="off" placeholder="请输入费率" class="layui-input" value="0.30">
                            </div>
                        </div>
                        <div class="layui-inline">
                            <label class="layui-form-label">云闪付费率1(%)</label>
                            <div class="layui-input-inline">
                                <input type="text" name="sxfUnionPayRate" lay-verify="baifenbi" autocomplete="off" placeholder="请输入费率" class="layui-input" value="0.30">
                            </div>
                        </div>
                        <div class="layui-inline">
                            <label class="layui-form-label">云闪付费率2(%)</label>
                            <div class="layui-input-inline">
                                <input type="text" name="sxfUnionPayRatetwo" lay-verify="baifenbi" autocomplete="off" placeholder="请输入费率" class="layui-input" value="0.30">
                            </div>
                        </div>
                        <div class="layui-inline  nowHide">
                            <label class="layui-form-label">京东钱包费率(%)</label>
                            <div class="layui-input-inline">
                                <input type="text" name="sxfJDWallet" lay-verify="baifenbi" autocomplete="off" placeholder="请输入费率" class="layui-input" value="0.30">
                            </div>
                        </div>
                        <div class="layui-inline  nowHide">
                            <label class="layui-form-label">qq钱包费率(%)</label>
                            <div class="layui-input-inline">
                                <input type="text" name="sxfQQWallet" lay-verify="baifenbi" autocomplete="off" placeholder="请输入费率" class="layui-input" value="0.30">
                            </div>
                        </div>
                        <div class="layui-inline  nowHide">
                            <label class="layui-form-label">翼支付费率(%)</label>
                            <div class="layui-input-inline">
                                <input type="text" name="sxfWingPayRate" lay-verify="baifenbi" autocomplete="off" placeholder="请输入费率" class="layui-input" value="0.30">
                            </div>
                        </div>
                    </div>
                </fieldset>
                <fieldset class="layui-elem-field layui-field-title ls" style="display:none">
                    <legend>乐刷通道</legend>
                    <fieldset style="border-color: #fff;">
                        <legend style="font-size:12px">扫码成本</legend>
                        <div class="layui-form-item">
                            <div class="layui-inline">
                                <label class="layui-form-label">支/微费率(%)</label>
                                <div class="layui-input-inline">
                                    <input type="text" name="lsweChatRate" lay-verify="aliorwxRate" autocomplete="off" placeholder="建议费率 0.23-0.60" class="layui-input" value="">
                                </div>
                            </div>
                            <!-- <div class="layui-inline">
                            <label class="layui-form-label">支付宝费率(%)</label>
                            <div class="layui-input-inline">
                                <input type="text" name="lsaliRate" lay-verify="baifenbi" autocomplete="off" placeholder="请输入费率" class="layui-input" value="0.30">
                            </div>
                        </div> -->
                            <div class="layui-inline">
                                <label class="layui-form-label">云闪付费率1(%)</label>
                                <div class="layui-input-inline">
                                    <input type="text" name="lsUnionPayRate" lay-verify="ysf1Rate" autocomplete="off" placeholder="建议费率 0.23-1.00" class="layui-input" value="">
                                </div>
                            </div>
                            <div class="layui-inline">
                                <label class="layui-form-label">云闪付费率2(%)</label>
                                <div class="layui-input-inline">
                                    <input type="text" name="lsUnionPayRatetwo" lay-verify="ysf2Rate" autocomplete="off" placeholder="建议费率 0.52-1.00" class="layui-input" value="">
                                </div>
                            </div>
                            <div class="layui-inline  nowHide">
                                <label class="layui-form-label">京东钱包费率(%)</label>
                                <div class="layui-input-inline">
                                    <input type="text" name="lsJDWallet" lay-verify="baifenbi" autocomplete="off" placeholder="请输入费率" class="layui-input" value="">
                                </div>
                            </div>
                            <div class="layui-inline  nowHide">
                                <label class="layui-form-label">qq钱包费率(%)</label>
                                <div class="layui-input-inline">
                                    <input type="text" name="lsQQWallet" lay-verify="baifenbi" autocomplete="off" placeholder="请输入费率" class="layui-input" value="">
                                </div>
                            </div>
                            <div class="layui-inline  nowHide">
                                <label class="layui-form-label">翼支付费率(%)</label>
                                <div class="layui-input-inline">
                                    <input type="text" name="lsWingPayRate" lay-verify="baifenbi" autocomplete="off" placeholder="请输入费率" class="layui-input" value="">
                                </div>
                            </div>
                        </div>
                    </fieldset>
                    <fieldset style="border-color: #fff">
                        <legend style="font-size:12px">刷卡成本</legend>
                        <div class="layui-form-item">
                            <div class="layui-inline">
                                <label class="layui-form-label">借记卡D1(%)</label>
                                <div class="layui-input-inline">
                                    <input type="text" name="lsDebitCardD1" lay-verify="lsDebitCardD1" autocomplete="off" placeholder="建议费率 0.40-1" class="layui-input" value="">
                                </div>
                            </div>
                            <div class="layui-inline">
                                <label class="layui-form-label">贷记卡D1(%)</label>
                                <div class="layui-input-inline">
                                    <input type="text" name="lsCreditCardD1" lay-verify="lsCreditCardD1" autocomplete="off" placeholder="建议费率 0.51-1.00" class="layui-input" value="">
                                </div>
                            </div>
                            <div class="layui-inline">
                                <label class="layui-form-label">借记卡D0(%)</label>
                                <div class="layui-input-inline">
                                    <input type="text" name="lsDebitCardD0" lay-verify="lsDebitCardD0" autocomplete="off" placeholder="建议费率 0.42-1.00" class="layui-input" value="">
                                </div>
                            </div>
                            <div class="layui-inline">
                                <label class="layui-form-label">贷记卡D0(%)</label>
                                <div class="layui-input-inline">
                                    <input type="text" name="lsCreditCardD0" lay-verify="lsCreditCardD0" autocomplete="off" placeholder="建议费率 0.53-1.00" class="layui-input" value="">
                                </div>
                            </div>
                        </div>
                    </fieldset>
                </fieldset>
                <fieldset class="layui-elem-field layui-field-title ls" style="display:none">
                    <legend>花呗分期抽成比例</legend>
                    <div class="layui-form-item">
                        <label class="layui-form-label">花呗分期抽成比例(%)</label>
                        <div class="layui-input-inline" style="width:200px">
                            <input type="number" id="proportional" name="proportional" required="" lay-verify="percentage" autocomplete="off" class="layui-input" placeholder="建议1-100之间" onmousewheel="return false;">
                        </div>
                    </div>
                </fieldset>
                <div class="layui-form-item layui-layout-admin">
                    <div class="layui-input-block">
                        <div class="layui-footer" style="left: 0;text-align: center;">
                            <button class="layui-btn" lay-submit="" lay-filter="add">立即提交</button>
                            <button type="reset" class="layui-btn layui-btn-primary" id="quxiao">取消</button>
                        </div>
                        <!--<i class="layui-icon" lay-tips="推荐追求开发效率和缺乏前端开发经验的使用，后端开发者的最爱。">123123123</i>-->
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="../../common/config-agent.js"></script>
    <script src="../../common/utility.js"></script>
    <script>
    var index = parent.layer.getFrameIndex(window.name);
    var pyList = new Array()
    $('#quxiao').click(function() {

        setTimeout(function() { parent.layer.close(index) }, 16);
    })

    function subPage(data, data1) {
        var jgData = data
        console.log(jgData)
        var rateList = ['0.20', '0.21', '0.22', '0.23', '0.24', '0.25', '0.26', '0.27', '0.28', '', '0.35', '0.38', '0.40', '0.50', '0.60']

        console.log(rateList)
        var strate = '<option value="">请选择费率</option>'
        for (var r = 0; r < rateList.length; r++) {
            strate += '<option value="' + rateList[r] / 100 + '">' + rateList[r] + '%</option>'
        }

        $('.rateBox').html(strate)
        var st = strate
        $('.xdlD1').html(st += '<option value="0.00235">0.235%</option>')
        $('.xdlD0').html(st += '<option value="0.00255">0.255%</option>')
        var p = [],
            c = [],
            aa = []
        var serverUrl = window.parent.serverUrl
        var userNumber = JSON.parse(sessionStorage.getItem('agentUser')).institutionNumber;
        var agentNumber = jgData.agentNumber
        layui.use(['laydate', 'table', 'upload', 'form'], function() {
            var $ = layui.jquery,
                upload = layui.upload,
                laydate = layui.laydate,
                table = layui.table,
                form = layui.form,
                admin = layui.admin,
                element = layui.element,
                layer = layui.layer;
            var tableSelect = layui.tableSelect;

            CmsUtility.postAjaxCall(
                //系统设置
                CmsConfig.addressUrl.Agent.getChannel + '?institutionNumber=' + JSON.parse(sessionStorage.getItem('agentUser')).institutionNumber, {
                    "page": 1,
                    "limit": 10
                },
                function(data) {
                    console.log(data)
                    if (data.code == '1000') {

                        for (var i = 0; i < data.data.PaymentChannellist.length; i++) {
                            switch (data.data.PaymentChannellist[i].paymentChannelType) {
                                case 0:
                                    console.log('123')
                                    if (data.data.PaymentChannellist[i].disable == 0) {
                                        $('.alipay').show()
                                        pyList.push(0)
                                    }

                                    break;
                                case 1:
                                    if (data.data.PaymentChannellist[i].disable == 0) {
                                        $('.wechatpay').show()
                                        pyList.push(1)
                                    }

                                    break;
                                case 2:
                                    if (data.data.PaymentChannellist[i].disable == 0) {
                                        $('.fuyou').show()
                                        pyList.push(2)
                                    }

                                    break;
                                case 3:
                                    if (data.data.PaymentChannellist[i].disable == 0) {
                                        $('.yrm').show()
                                        pyList.push(3)
                                    }

                                    break;
                                case 4:
                                    if (data.data.PaymentChannellist[i].disable == 0) {
                                        $('.xdl').show()
                                        pyList.push(4)
                                    }

                                    break;
                                case 5:
                                    if (data.data.PaymentChannellist[i].disable == 0) {
                                        $('.sxf').show()
                                        pyList.push(5)
                                    }

                                    break;
                                case 6:
                                    if (data.data.PaymentChannellist[i].disable == 0) {
                                        $('.ls').show()
                                        pyList.push(6)
                                    }

                                    break;
                                default:
                                    // statements_def
                                    break;
                            }
                        }
                        console.log(pyList)
                        if (pyList.indexOf(0) < 0) {
                            removeElementsByClass('alipay')
                        }
                        if (pyList.indexOf(1) < 0) {
                            removeElementsByClass('wechatpay')
                        }
                        if (pyList.indexOf(2) < 0) {
                            removeElementsByClass('fuyou')
                        }
                        if (pyList.indexOf(3) < 0) {
                            removeElementsByClass('yrm')
                        }
                        if (pyList.indexOf(4) < 0) {
                            removeElementsByClass('xdl')
                        }
                        if (pyList.indexOf(5) < 0) {
                            removeElementsByClass('sxf')
                        }
                        if (pyList.indexOf(6) < 0) {
                            removeElementsByClass('ls')
                        }
                    } else {

                    }
                },
                function(data) {
                    console.log('222')
                }
            )
            window.removeElementsByClass = function(className) {
                var elements = document.getElementsByClassName(className);
                while (elements.length > 0) {
                    elements[0].parentNode.removeChild(elements[0]);
                }
            }
            CmsUtility.postAjaxCall(
                //系统设置
                CmsConfig.addressUrl.Public.getAreajson, {},
                function(data) {
                    sessionStorage.setItem("address", data.data);
                    address = JSON.parse(data.data)
                    for (var i = 0; i < address.length; i++) {
                        var a = new Object()
                        a.provinceCode = address[i].value
                        a.provinceName = address[i].text
                        p.push(a)
                        var b = new Object()
                        b.provinceCode = address[i].value
                        b.children = []
                        for (var k = 0; k < address[i].children.length; k++) {
                            var d = new Object()
                            d.cityCode = address[i].children[k].value
                            d.cityName = address[i].children[k].text
                            b.children.push(d)
                            var e = new Object()
                            e.cityCode = address[i].children[k].value
                            e.childeren = []
                            for (var j = 0; j < address[i].children[k].children.length; j++) {
                                var t = new Object()
                                t.areaCode = address[i].children[k].children[j].value
                                t.areaName = address[i].children[k].children[j].text
                                e.childeren.push(t)
                            }
                            aa.push(e)
                        }
                        c.push(b)

                    }
                    if (jgData.province) {
                        var str = '<option value="">请选择省</option>'
                        for (var i1 = 0; i1 < p.length; i1++) {
                            if (jgData.province == p[i1].provinceCode) {
                                str += '<option value="' + p[i1].provinceCode + '" selected="">' + p[i1].provinceName + '</option>'
                            } else {
                                str += '<option value="' + p[i1].provinceCode + '">' + p[i1].provinceName + '</option>'
                            }

                        }
                        $('#provice').html(str)
                    }
                    if (jgData.city) {
                        var str1 = '<option value="">请选择市</option>'
                        for (var i3 = 0; i3 < c.length; i3++) {

                            if (jgData.province == c[i3].provinceCode) {

                                for (var i2 = 0; i2 < c[i3].children.length; i2++) {

                                    if (jgData.city == c[i3].children[i2].cityCode) {
                                        console.log(c[i3].children[i2])
                                        str1 += '<option value="' + c[i3].children[i2].cityCode + '" selected="">' + c[i3].children[i2].cityName + '</option>'
                                    } else {
                                        str1 += '<option value="' + c[i3].children[i2].cityCode + '">' + c[i3].children[i2].cityName + '</option>'
                                    }

                                }
                            }
                        }
                        $('#city').html(str1)
                    }
                    if (jgData.area) {
                        var str2 = '<option value="">请选择县区</option>'
                        for (var i4 = 0; i4 < aa.length; i4++) {

                            if (jgData.city == aa[i4].cityCode) {

                                for (var i5 = 0; i5 < aa[i4].childeren.length; i5++) {

                                    if (jgData.area == aa[i4].childeren[i5].areaCode) {
                                        console.log(aa[i4].childeren[i5])
                                        str2 += '<option value="' + aa[i4].childeren[i5].areaCode + '" selected="">' + aa[i4].childeren[i5].areaName + '</option>'
                                    } else {
                                        str2 += '<option value="' + aa[i4].childeren[i5].areaCode + '">' + aa[i4].childeren[i5].areaName + '</option>'
                                    }

                                }
                            }
                        }
                        $('#area').html(str2)
                    }

                    form.val('cardAdd', {
                        // "agentType": jgData.agentType.toString(),
                        // "agentName": jgData.agentName,
                        // "userName": jgData.userName,
                        // "registerCell": jgData.registerCell,
                        // "province": jgData.province,
                        // "city": jgData.city,
                        // "area": jgData.area,
                        // "address": jgData.address,
                        // "T1Rate": T1,
                        // "wechatRate":jgData.wechatRate,
                        // "aliRate":jgData.aliRate,
                        // "fuyouRateD1":jgData.fuyouRateD1,
                        // "fuyouRateD0":jgData.fuyouRateD0,
                        // "xdlRateD0":jgData.xdlRateD0,
                        // "xdlRateD1":jgData.xdlRateD1,
                        // "yrmRateD1":jgData.yrmRateD1,
                        // "yrmRateD0":jgData.yrmRateD0,
                    })
                    form.render()
                },
                function(data) {
                    console.log(data)
                },
            )
            var rateList = []
            CmsUtility.postAjaxCall(
                //系统设置
                'agentManage/getAgentRate', {
                    "agentNumber": jgData.agentNumber
                },
                function(data) {
                    data.data.sort(compare('paymentChanneltype'))
                    var rateData = data.data
                    console.log(rateData)
                    for (var i = 0; i < data.data.length; i++) {
                        if (data.data[i].paymentChanneltype == 0) {
                            form.val('cardAdd', {

                                // "T1Rate": T1,

                                "gfAliRate": (data.data[i].rate * 100).toFixed(2),
                            })
                        }
                        if (data.data[i].paymentChanneltype == 1) {
                            form.val('cardAdd', {

                                "gfWeChatRate": (data.data[i].rate * 100).toFixed(2),
                            })

                        }
                        if (data.data[i].paymentChanneltype == 2) {




                            console.log()

                            switch (data.data[i].onePaymentTypeINT) {
                                case 0:
                                    form.val('cardAdd', {

                                        "fyaliRate": (data.data[i].rate * 100).toFixed(2),
                                    })
                                    break;
                                case 1:
                                    form.val('cardAdd', {

                                        "fyweChatRate": (data.data[i].rate * 100).toFixed(2),
                                    })
                                    break;
                                case 2:
                                    form.val('cardAdd', {

                                        "fyJDWallet": (data.data[i].rate * 100).toFixed(2),
                                    })
                                    break;
                                case 3:
                                    form.val('cardAdd', {

                                        "fyUnionPayRate": (data.data[i].rate * 100).toFixed(2),
                                    })
                                    form.val('cardAdd', {

                                        "fyUnionPayRatetwo": (data.data[i].ysfrate * 100).toFixed(2),
                                    })
                                    break;
                                case 5:
                                    form.val('cardAdd', {

                                        "fyQQWallet": (data.data[i].rate * 100).toFixed(2),
                                    })
                                    break;
                                case 6:
                                    form.val('cardAdd', {

                                        "fyWingPayRate": (data.data[i].rate * 100).toFixed(2),
                                    })
                                    break;
                                default:
                                    // statements_def
                                    break;
                            }


                        }

                        if (data.data[i].paymentChanneltype == 4) {
                            switch (data.data[i].onePaymentTypeINT) {
                                case 0:
                                    form.val('cardAdd', {

                                        "xdlaliRate": (data.data[i].rate * 100).toFixed(2),
                                    })
                                    break;
                                case 1:
                                    form.val('cardAdd', {

                                        "xdlweChatRate": (data.data[i].rate * 100).toFixed(2),
                                    })
                                    break;
                                case 2:
                                    form.val('cardAdd', {

                                        "xdlJDWallet": (data.data[i].rate * 100).toFixed(2),
                                    })
                                    break;
                                case 3:
                                    form.val('cardAdd', {

                                        "xdlUnionPayRate": (data.data[i].rate * 100).toFixed(2),
                                    })
                                    form.val('cardAdd', {

                                        "XdlUnionPayRatetwo": (data.data[i].ysfrate * 100).toFixed(2),
                                    })
                                    break;
                                case 5:
                                    form.val('cardAdd', {

                                        "xdlQQWallet": (data.data[i].rate * 100).toFixed(2),
                                    })
                                    break;
                                case 6:
                                    form.val('cardAdd', {

                                        "xdlWingPayRate": (data.data[i].rate * 100).toFixed(2),
                                    })
                                    break;
                                default:
                                    // statements_def
                                    break;
                            }


                        }
                        if (data.data[i].paymentChanneltype == 5) {
                            switch (data.data[i].onePaymentTypeINT) {
                                case 0:
                                    form.val('cardAdd', {

                                        "sxfaliRate": (data.data[i].rate * 100).toFixed(2),
                                    })
                                    break;
                                case 1:
                                    form.val('cardAdd', {

                                        "sxfweChatRate": (data.data[i].rate * 100).toFixed(2),
                                    })
                                    break;
                                case 2:
                                    form.val('cardAdd', {

                                        "sxfJDWallet": (data.data[i].rate * 100).toFixed(2),
                                    })
                                    break;
                                case 3:
                                    form.val('cardAdd', {

                                        "sxfUnionPayRate": (data.data[i].rate * 100).toFixed(2),
                                    })
                                    form.val('cardAdd', {

                                        "sxfUnionPayRatetwo": (data.data[i].ysfrate * 100).toFixed(2),
                                    })
                                    break;
                                case 5:
                                    form.val('cardAdd', {

                                        "sxfQQWallet": (data.data[i].rate * 100).toFixed(2),
                                    })
                                    break;
                                case 6:
                                    form.val('cardAdd', {

                                        "sxfWingPayRate": (data.data[i].rate * 100).toFixed(2),
                                    })
                                    break;
                                default:
                                    // statements_def
                                    break;
                            }


                        }
                        if (data.data[i].paymentChanneltype == 6) {
                            switch (data.data[i].onePaymentTypeINT) {
                                case 0:
                                    form.val('cardAdd', {

                                        "lsweChatRate": (data.data[i].rate * 100).toFixed(2),
                                    })
                                    break;
                                case 1:
                                    form.val('cardAdd', {

                                        "lsaliRate": (data.data[i].rate * 100).toFixed(2),
                                    })
                                    break;
                                case 2:
                                    form.val('cardAdd', {

                                        "lsJDWallet": (data.data[i].rate * 100).toFixed(2),
                                    })
                                    break;
                                case 3:
                                    form.val('cardAdd', {

                                        "lsUnionPayRate": (data.data[i].rate * 100).toFixed(2),
                                    })
                                    form.val('cardAdd', {

                                        "lsUnionPayRatetwo": (data.data[i].ysfrate * 100).toFixed(2),
                                    })
                                    break;
                                case 5:
                                    form.val('cardAdd', {

                                        "lsQQWallet": (data.data[i].rate * 100).toFixed(2),
                                    })
                                    break;
                                case 6:
                                    form.val('cardAdd', {

                                        "lsWingPayRate": (data.data[i].rate * 100).toFixed(2),
                                    })
                                    break;
                                case 7:
                                    form.val('cardAdd', {

                                        "lsCreditCardD0": (data.data[i].lsCreditCardD0 * 100).toFixed(2),
                                        "lsCreditCardD1": (data.data[i].lsCreditCardD1 * 100).toFixed(2),
                                        "lsDebitCardD0": (data.data[i].lsDebitCardD0 * 100).toFixed(2),
                                        "lsDebitCardD1": (data.data[i].lsDebitCardD1 * 100).toFixed(2),
                                    })
                                    break;
                                default:
                                    // statements_def
                                    break;
                            }


                        }
                    }
                    form.val('cardAdd', {

                        "proportional": (jgData.proportional * 100).toFixed(2),
                    })
                    // form.val('cardAdd', {

                    //     // "T1Rate": T1,

                    //     "aliRate":rateData[0].rate || '',
                    //     "wecharRate":rateData[1].rate || '',
                    //     "fuyouRateD1":rateData[2].rate || '',
                    //     "fuyouRateD0":rateData[3].rate || '',

                    //     "yrmRateD1":rateData[4].rate || '',
                    //     "yrmRateD0":rateData[5].rate || '',
                    //     "xdlRateD1":rateData[6].rate || '',
                    //     "xdlRateD0":rateData[7].rate || '',
                    // })
                    form.render()
                },
                function(data) {

                }
            )

            function compare(property) {
                return function(a, b) {
                    var value1 = a[property];
                    var value2 = b[property];
                    return value1 - value2;
                }
            }
            // var Arr = jgData.Rate.split('|')
            // var nO = new Array()
            // var T1, D1, D0;
            // for (var i = 0; i < Arr.length; i++) {
            //     if (Arr[i].split(':')[0] == 'T1') {
            //         T1 = Arr[i].split(':')[1]
            //     }
            //     if (Arr[i].split(':')[0] == 'D1') {
            //         D1 = Arr[i].split(':')[1]
            //     }
            //     if (Arr[i].split(':')[0] == 'D0') {
            //         D0 = Arr[i].split(':')[1]
            //     }
            // }
            form.render()

            setTimeout(function() {
                form.render()
            }, 300)
            // if(!!jgData.province){
            //  console.log()
            //  CmsUtility.choosePro(jgData.province);
            // }
            // if(!!jgData.province  && !!jgData.city){
            //  console.log(jgData.province,jgData.city )
            //  CmsUtility.chooseCity(jgData.province,jgData.city)
            // }
            // if(!!jgData.city  &&  !!jgData.area){
            //  CmsUtility.chooseArea(jgData.city,jgData.area)
            // }


            form.on('select(provice)', function(data) {

                var str1 = '<option value="">请选择市</option>'
                for (var i3 = 0; i3 < c.length; i3++) {

                    if (data.value == c[i3].provinceCode) {

                        for (var i2 = 0; i2 < c[i3].children.length; i2++) {


                            str1 += '<option value="' + c[i3].children[i2].cityCode + '">' + c[i3].children[i2].cityName + '</option>'


                        }
                    }
                }
                $('#city').html(str1)
                var str2 = '<option value="">请选择县区</option>'
                $('#area').html(str2)
                form.render()

            })
            form.on('select(city)', function(data) {

                var str2 = '<option value="">请选择县区</option>'
                for (var i4 = 0; i4 < aa.length; i4++) {
                    if (data.value == aa[i4].cityCode) {
                        for (var i5 = 0; i5 < aa[i4].childeren.length; i5++) {


                            str2 += '<option value="' + aa[i4].childeren[i5].areaCode + '">' + aa[i4].childeren[i5].areaName + '</option>'


                        }
                    }
                }
                $('#area').html(str2)
                form.render()

            })
            /*---------- 自定义验证规则 ----------*/
            form.verify({
                title: function(value) {
                    if (value == null) {
                        return '不能为空！';
                    }
                    if (value.length == "") {
                        return '不能为空！';
                    }
                },
                baifenbi: function(value) {
                    // if(value.length != ''){
                    //     if(value.indexOf('%')<0){
                    //         return '费率格式不正确'
                    //     }
                    // }

                },
                percentage: function(value) {
                    if (!value.length) {
                        return '花呗分期抽成比例不能为空'
                    }
                    if (isNaN(value) == true) {
                        return '请输入数字'
                    }
                    if (value < 0 || value > 100) {
                        return '花呗分期抽成比例需在0-100之间'
                    }
                },
                lsDebitCardD1: function(value) {
                    if (parseFloat(value) < 0.40 || parseFloat(value) > 1 || value == '') {
                        return '借记卡D1费率只能在 0.40~1.00 之间'
                    }
                },
                lsCreditCardD1: function(value) {
                    if (parseFloat(value) < 0.51 || parseFloat(value) > 1 || value == '') {
                        return '贷记卡D1费率只能在 0.51~1.00 之间'
                    }
                },
                lsDebitCardD0: function(value) {
                    if (parseFloat(value) < 0.42 || parseFloat(value) > 1 || value == '') {
                        return '借记卡D0费率只能在 0.42~1.00 之间'
                    }
                },
                lsCreditCardD0: function(value) {
                    if (parseFloat(value) < 0.53 || parseFloat(value) > 1 || value == '') {
                        return '贷记卡D0费率只能在 0.53~1.00 之间'
                    }
                },
            });
            /*---------- 监听提交 ----------*/
            form.on('submit(add)', function(data, index) {
                var addData = data.field
                addData.institutionNumber = userNumber
                addData.deletionFlag = '0'
                addData.agentNumber = jgData.agentNumber
                addData.pAgentNumber = JSON.parse(sessionStorage.getItem('agentUser')).Number
                if (jgData.pAgentLevel == '--') {
                    addData.agentLevel = 'A'
                }
                if (jgData.pAgentLevel == 'A') {
                    addData.agentLevel = 'B'
                }
                if (jgData.pAgentLevel == 'B') {
                    addData.agentLevel = 'C'
                }
                if (jgData.pAgentLevel == 'C') {
                    addData.agentLevel = 'D'
                }
                if (pyList.indexOf(0) >= 0) {
                    addData.gfAliRate = (addData.gfAliRate / 10000 * 100).toFixed(4)
                } else if (pyList.indexOf(0) < 0) {
                    delete addData.gfAliRate
                }
                if (pyList.indexOf(1) >= 0) {
                    addData.gfWeChatRate = (addData.gfWeChatRate / 10000 * 100).toFixed(4)
                } else if (pyList.indexOf(1) < 0) {
                    delete addData.gfWeChatRate
                }
                if (pyList.indexOf(2) >= 0) {
                    addData.fyweChatRate = (addData.fyweChatRate / 10000 * 100).toFixed(4)
                    addData.fyaliRate = addData.fyweChatRate
                    addData.fyUnionPayRate = (addData.fyUnionPayRate / 10000 * 100).toFixed(4)
                    addData.fyJDWallet = (addData.fyJDWallet / 10000 * 100).toFixed(4)
                    addData.fyQQWallet = (addData.fyQQWallet / 10000 * 100).toFixed(4)
                    addData.fyUnionPayRatetwo = (addData.fyUnionPayRatetwo / 10000 * 100).toFixed(4)
                    addData.fyWingPayRate = (addData.fyWingPayRate / 10000 * 100).toFixed(4)
                } else if (pyList.indexOf(2) < 0) {
                    delete addData.fyweChatRate
                    delete addData.fyaliRate
                    delete addData.fyUnionPayRate
                    delete addData.fyJDWallet
                    delete addData.fyQQWallet
                    delete addData.fyUnionPayRatetwo
                    delete addData.fyWingPayRate
                }
                if (pyList.indexOf(3) < 0) {




                }
                if (pyList.indexOf(4) >= 0) {
                    addData.xdlweChatRate = (addData.xdlweChatRate / 10000 * 100).toFixed(4)

                    addData.xdlaliRate = addData.xdlweChatRate

                    addData.xdlUnionPayRate = (addData.xdlUnionPayRate / 10000 * 100).toFixed(4)

                    addData.xdlJDWallet = (addData.xdlJDWallet / 10000 * 100).toFixed(4)

                    addData.xdlQQWallet = (addData.xdlQQWallet / 10000 * 100).toFixed(4)

                    addData.XdlUnionPayRatetwo = (addData.XdlUnionPayRatetwo / 10000 * 100).toFixed(4)
                    addData.xdlWingPayRate = (addData.xdlWingPayRate / 10000 * 100).toFixed(4)


                } else if (pyList.indexOf(4) < 0) {
                    delete addData.xdlweChatRate
                    delete addData.xdlaliRate
                    delete addData.xdlUnionPayRate
                    delete addData.xdlJDWallet
                    delete addData.xdlQQWallet
                    delete addData.XdlUnionPayRatetwo
                    delete addData.xdlWingPayRate
                }
                if (pyList.indexOf(5) >= 0) {

                    addData.sxfweChatRate = (addData.sxfweChatRate / 10000 * 100).toFixed(4)

                    addData.sxfaliRate = addData.sxfweChatRate

                    addData.sxfUnionPayRate = (addData.sxfUnionPayRate / 10000 * 100).toFixed(4)

                    addData.sxfJDWallet = (addData.sxfJDWallet / 10000 * 100).toFixed(4)

                    addData.sxfQQWallet = (addData.sxfQQWallet / 10000 * 100).toFixed(4)

                    addData.sxfUnionPayRatetwo = (addData.sxfUnionPayRatetwo / 10000 * 100).toFixed(4)
                    addData.sxfWingPayRate = (addData.sxfWingPayRate / 10000 * 100).toFixed(4)


                } else if (pyList.indexOf(5) < 0) {
                    delete addData.sxfweChatRate
                    delete addData.sxfaliRate
                    delete addData.sxfUnionPayRate
                    delete addData.sxfJDWallet
                    delete addData.sxfQQWallet
                    delete addData.sxfUnionPayRatetwo
                    delete addData.sxfWingPayRate
                }
                if (pyList.indexOf(6) >= 0) {
                    addData.lsUnionPayRatetwo = (addData.lsUnionPayRatetwo / 100).toFixed(4)



                    addData.lsweChatRate = (addData.lsweChatRate / 100).toFixed(4)
                    addData.lsaliRate = addData.lsweChatRate
                    addData.lsUnionPayRate = (addData.lsUnionPayRate / 100).toFixed(4)

                    addData.lsJDWallet = (addData.lsJDWallet / 100).toFixed(4)
                    addData.lsQQWallet = (addData.lsQQWallet / 100).toFixed(4)



                    addData.lsWingPayRate = (addData.lsWingPayRate / 100).toFixed(4)
                    addData.lsDebitCardD0 = (addData.lsDebitCardD0 / 100).toFixed(4)
                    addData.lsCreditCardD0 = (addData.lsCreditCardD0 / 100).toFixed(4)
                    addData.lsDebitCardD1 = (addData.lsDebitCardD1 / 100).toFixed(4)
                    addData.lsCreditCardD1 = (addData.lsCreditCardD1 / 100).toFixed(4)

                } else if (pyList.indexOf(6) < 0) {
                    delete addData.lsUnionPayRatetwo
                    delete addData.lsweChatRate
                    delete addData.lsaliRate
                    delete addData.lsUnionPayRate
                    delete addData.lsJDWallet
                    delete addData.lsQQWallet
                    delete addData.lsWingPayRate
                    delete addData.lsDebitCardD0
                    delete addData.lsCreditCardD0
                    delete addData.lsDebitCardD1
                    delete addData.lsCreditCardD1
                }

                addData.pAgentLevel = JSON.parse(sessionStorage.getItem('agentUser')).agentLevel
                addData.agentLevel = jgData.agentLevel
                addData.proportional = (addData.proportional / 10000 * 100).toFixed(4)

                console.log(addData)
                var index = layer.load(2, { shade: [0.4, '#393D49'] })
                // 发送请求
                CmsUtility.postAjaxCall(
                    //系统设置
                    CmsConfig.addressUrl.Agent.updataAgentRate,
                    addData,
                    function(data) {
                        layer.closeAll()
                        if (data.code == 1000) {
                            setTimeout(function() {
                                $('#quxiao').click()
                            }, 16);
                            parent.layer.msg('更改成功')
                            parent.layui.table.reload('salesmanList')
                        } else {
                            layer.msg(data.msg)
                        }
                    },
                    function(data) {
                        console.log('222')
                    }
                )
                return false;
            });
        });
    }
    </script>
</body>

</html>